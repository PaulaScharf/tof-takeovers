#include <TensorFlowLite.h>

#include "tensorflow/lite/micro/kernels/micro_ops.h"
#include "tensorflow/lite/micro/micro_interpreter.h"
#include "tensorflow/lite/micro/micro_mutable_op_resolver.h"
#include "tensorflow/lite/micro/all_ops_resolver.h"
#include "tensorflow/lite/schema/schema_generated.h"

#include <Arduino.h>
#include <Wire.h>
#include <vl53l8cx_class.h>

#define kChannelNumber 64
#define kFrameNumber 20

// Mean array
    double means[] = {330.4747126436782, 368.8831417624521, 388.8724137931035, 427.7295019157088, 442.37969348659004, 376.27777777777777, 371.1850574712644, 268.29693486590037, 220.96858237547892, 219.9367816091954, 190.58122605363985, 199.8432950191571, 246.74176245210728, 193.7888888888889, 177.83409961685823, 184.40076628352492, 204.33563218390805, 129.9624521072797, 127.41570881226053, 131.3088122605364, 163.7793103448276, 131.2015325670498, 120.10114942528736, 183.6103448275862, 207.3080459770115, 144.9551724137931, 127.70689655172414, 130.1961685823755, 128.7111111111111, 142.172030651341, 125.75670498084291, 201.01647509578544, 203.75134099616858, 137.63869731800767, 119.91417624521073, 132.45402298850576, 129.1103448275862, 134.17624521072796, 153.30842911877394, 211.49655172413793, 219.0831417624521, 142.22681992337164, 117.79693486590038, 123.15019157088122, 129.36819923371647, 143.47547892720306, 162.63563218390806, 242.41532567049808, 194.92911877394636, 173.70957854406132, 132.32260536398468, 136.1793103448276, 157.35249042145594, 196.93295019157088, 194.73946360153258, 223.85249042145594, 184.85900383141762, 188.09233716475094, 170.02260536398467, 143.57164750957855, 157.67509578544062, 197.39003831417625, 211.78429118773946, 162.00191570881225, 334.1360153256705, 389.44329501915706, 389.9854406130268, 431.5425287356322, 473.1241379310345, 395.43371647509576, 386.72260536398466, 272.7567049808429, 247.3176245210728, 226.69157088122606, 203.7969348659004, 206.20344827586206, 249.1007662835249, 203.92452107279692, 175.71417624521072, 197.3904214559387, 241.26781609195402, 148.8183908045977, 136.1911877394636, 136.1463601532567, 166.12337164750957, 131.62835249042146, 134.3536398467433, 192.13065134099617, 236.32681992337166, 148.72030651340995, 133.8233716475096, 133.3873563218391, 127.5632183908046, 142.60651340996168, 125.94942528735632, 210.1632183908046, 214.38812260536398, 142.64367816091954, 123.70153256704981, 129.7375478927203, 133.3727969348659, 133.8007662835249, 157.32528735632184, 220.5800766283525, 222.91226053639846, 142.78812260536398, 121.3367816091954, 123.58505747126436, 127.64865900383141, 143.84291187739464, 164.25708812260535, 250.80842911877394, 201.4241379310345, 173.19386973180076, 138.49885057471263, 136.32950191570882, 158.97011494252874, 195.65402298850574, 195.98697318007663, 230.70727969348658, 192.86743295019158, 193.26130268199233, 178.86819923371647, 155.48620689655172, 161.01839080459771, 199.05249042145593, 217.17816091954023, 157.58773946360154, 354.2689655172414, 417.0252873563218, 411.0406130268199, 473.96360153256705, 502.5823754789272, 422.81226053639847, 413.0973180076628, 290.83639846743296, 276.0823754789272, 253.16858237547893, 243.35632183908046, 246.51302681992337, 283.85172413793106, 226.827969348659, 196.77662835249043, 212.02107279693487, 270.78275862068966, 173.24329501915707, 174.3704980842912, 165.70842911877395, 201.76934865900384, 157.73371647509578, 160.09386973180077, 200.08505747126438, 275.88007662835247, 182.96819923371646, 166.02528735632183, 149.8823754789272, 151.57777777777778, 160.57471264367817, 142.0145593869732, 230.92337164750958, 237.65325670498083, 174.02528735632183, 142.42988505747127, 146.7750957854406, 148.98429118773947, 146.97241379310344, 178.1494252873563, 235.1471264367816, 245.56015325670498, 158.15095785440613, 142.16283524904213, 144.63141762452108, 143.7471264367816, 149.60229885057473, 169.08275862068965, 262.61494252873564, 219.65057471264367, 186.4528735632184, 153.1911877394636, 146.98697318007663, 167.2551724137931, 202.9919540229885, 193.16666666666666, 223.34367816091955, 206.32988505747127, 208.2448275862069, 195.37394636015327, 166.80344827586208, 168.85977011494253, 205.58122605363985, 220.20344827586206, 166.87662835249043, 394.0344827586207, 437.8264367816092, 449.46858237547895, 507.63486590038315, 531.92030651341, 454.4448275862069, 427.4704980842912, 319.6873563218391, 304.6471264367816, 285.03678160919543, 275.8766283524904, 279.6908045977012, 318.4011494252874, 262.17241379310343, 219.80268199233717, 239.43524904214559, 306.43409961685825, 217.0536398467433, 216.56704980842912, 211.76436781609195, 244.80229885057472, 195.51379310344828, 186.43639846743295, 221.96436781609196, 303.01647509578544, 228.55555555555554, 212.03563218390804, 209.27471264367816, 195.68735632183908, 192.12030651340996, 175.5176245210728, 243.5662835249042, 270.5249042145594, 211.96360153256705, 182.04674329501916, 194.7471264367816, 195.3969348659004, 181.72413793103448, 195.44942528735632, 253.93180076628352, 269.61034482758623, 184.90804597701148, 165.06513409961687, 170.77471264367816, 161.1264367816092, 172.5662835249042, 187.91494252873562, 277.9647509578544, 238.455938697318, 200.01954022988505, 171.92835249042145, 164.73333333333332, 189.21494252873563, 213.2992337164751, 211.77164750957854, 233.9831417624521, 221.48659003831418, 221.7030651340996, 210.33180076628352, 180.99961685823754, 182.41570881226053, 220.78122605363984, 233.16743295019157, 175.61724137931034, 402.2689655172414, 466.43333333333334, 485.39540229885057, 543.9233716475096, 547.4268199233717, 469.8486590038314, 445.36590038314176, 331.0750957854406, 336.50727969348657, 333.43908045977014, 324.16858237547893, 329.02260536398467, 368.70268199233715, 294.9800766283525, 266.6647509578544, 255.6919540229885, 331.7632183908046, 250.84406130268198, 262.48735632183906, 267.6908045977012, 291.59616858237547, 243.20842911877395, 230.94137931034481, 254.69157088122606, 331.69310344827585, 276.9908045977011, 251.07547892720308, 270.5501915708812, 260.12988505747126, 236.88659003831418, 215.36590038314176, 271.7168582375479, 311.0885057471264, 252.28122605363984, 240.9214559386973, 258.74597701149423, 249.9655172413793, 227.40038314176246, 224.34865900383141, 273.6448275862069, 292.06283524904217, 210.30191570881226, 192.1471264367816, 209.26513409961686, 204.5590038314176, 201.37586206896552, 215.22145593869732, 283.34597701149426, 256.23793103448276, 229.17049808429118, 190.45555555555555, 194.3727969348659, 215.411877394636, 234.9241379310345, 234.71226053639847, 245.0888888888889, 234.50038314176246, 239.93563218390804, 226.7942528735632, 197.34022988505748, 206.25325670498086, 237.5360153256705, 242.15325670498083, 187.5904214559387, 458.71302681992336, 496.8674329501916, 512.7616858237548, 578.7348659003832, 591.7885057471265, 503.57164750957855, 460.59578544061304, 359.4068965517241, 369.9888888888889, 376.71264367816093, 370.48122605363983, 380.02260536398467, 412.2452107279693, 342.98812260536397, 307.21800766283525, 283.41302681992335, 378.27739463601534, 305.1862068965517, 309.6122605363985, 313.9210727969349, 347.9593869731801, 290.8245210727969, 275.66819923371645, 295.0977011494253, 372.86590038314176, 316.1352490421456, 299.23409961685826, 318.45478927203067, 307.1831417624521, 286.31187739463604, 267.48275862068965, 306.59961685823754, 354.6704980842912, 299.05325670498087, 288.7513409961686, 310.4314176245211, 302.7260536398467, 280.5647509578544, 272.6409961685824, 307.8080459770115, 324.71800766283525, 252.7793103448276, 231.19003831417623, 255.68352490421455, 245.95708812260537, 239.06283524904214, 239.9712643678161, 311.0639846743295, 281.05708812260536, 260.35977011494253, 227.83448275862068, 232.0486590038314, 250.25977011494254, 264.68429118773946, 258.8624521072797, 261.3494252873563, 258.8088122605364, 264.82681992337166, 250.90344827586208, 234.97164750957853, 234.98659003831418, 261.2068965517241, 271.3022988505747, 208.89501915708811, 502.0494252873563, 533.6252873563218, 540.7743295019158, 619.4501915708812, 638.3026819923372, 523.4394636015326, 500.804214559387, 386.9206896551724, 402.12988505747126, 422.7452107279693, 410.3432950191571, 431.1551724137931, 475.32567049808426, 391.9574712643678, 351.6180076628352, 320.9015325670498, 409.8911877394636, 341.24252873563216, 356.7639846743295, 366.14521072796936, 400.1666666666667, 337.7605363984674, 314.55708812260536, 329.3022988505747, 411.1823754789272, 363.4908045977011, 349.70766283524904, 370.235632183908, 362.34597701149426, 341.6904214559387, 314.01302681992337, 350.72452107279696, 386.42911877394636, 345.2547892720307, 333.73793103448276, 357.24291187739465, 356.2823754789272, 329.8712643678161, 320.67854406130266, 357.7176245210728, 344.8088122605364, 279.99310344827586, 273.69961685823756, 296.4934865900383, 289.70842911877395, 288.58620689655174, 286.4605363984674, 336.3808429118774, 308.6846743295019, 290.91072796934867, 261.3417624521073, 274.48773946360154, 292.4498084291188, 302.03333333333336, 292.36206896551727, 288.34980842911875, 293.1800766283525, 292.7302681992337, 284.77164750957854, 273.9697318007663, 278.6773946360153, 297.0436781609195, 298.61877394636014, 232.94827586206895, 514.4957854406131, 553.9452107279693, 570.3808429118774, 641.3586206896551, 661.2038314176245, 563.8662835249042, 510.84214559386976, 413.7015325670498, 434.19003831417626, 469.0394636015326, 458.8681992337165, 484.0770114942529, 526.992337164751, 427.6333333333333, 392.31111111111113, 362.416091954023, 440.8049808429119, 392.45785440613025, 409.12528735632185, 420.7095785440613, 452.68199233716473, 393.02145593869733, 361.13448275862066, 360.38505747126436, 435.2842911877395, 417.3536398467433, 407.3340996168582, 424.4406130268199, 414.07547892720305, 400.7394636015326, 368.907662835249, 383.00114942528734, 424.1911877394636, 377.0478927203065, 382.61532567049807, 409.3233716475096, 411.99157088122604, 378.71724137931034, 368.1666666666667, 392.2103448275862, 371.44865900383144, 320.64827586206894, 310.90919540229885, 351.4670498084291, 342.04214559386975, 326.0674329501916, 325.07049808429116, 362.43295019157085, 331.9509578544061, 321.9501915708812, 300.1961685823755, 317.8176245210728, 332.3176245210728, 345.68275862068964, 322.9904214559387, 305.42988505747127, 312.52758620689656, 322.8904214559387, 323.3919540229885, 307.59463601532565, 312.55172413793105, 335.05478927203063, 336.932183908046, 262.1777777777778, 519.0038314176245, 570.0954022988506, 578.5214559386973, 662.5318007662835, 683.8766283524905, 571.3505747126437, 521.9432950191571, 440.1563218390805, 443.6471264367816, 493.2528735632184, 486.7241379310345, 515.587356321839, 559.2061302681992, 463.02260536398467, 425.1865900383142, 384.30153256704983, 467.191570881226, 413.9712643678161, 429.57088122605364, 458.6551724137931, 483.5352490421456, 421.8628352490421, 391.63946360153255, 392.9609195402299, 460.55555555555554, 442.37547892720306, 432.9942528735632, 465.4030651340996, 459.76513409961683, 433.9942528735632, 407.53678160919543, 420.56628352490424, 443.6222222222222, 416.08927203065133, 421.039846743295, 454.68773946360153, 446.37931034482756, 415.60536398467434, 412.9754789272031, 419.4471264367816, 388.3478927203065, 350.30996168582374, 345.19310344827585, 382.79616858237546, 374.87088122605365, 354.844061302682, 352.9854406130268, 382.6574712643678, 353.9114942528736, 346.0291187739464, 329.63409961685824, 349.0360153256705, 366.0249042145594, 377.08620689655174, 352.5141762452107, 327.62911877394635, 329.1026819923372, 340.5992337164751, 344.76513409961683, 335.55325670498087, 351.2800766283525, 358.0015325670498, 368.8463601532567, 270.56666666666666, 516.8639846743295, 571.3712643678161, 581.0655172413793, 657.9432950191571, 675.5145593869731, 568.0582375478928, 529.0846743295019, 447.6647509578544, 440.3091954022988, 489.9961685823755, 475.1360153256705, 533.7176245210728, 580.9854406130269, 475.33065134099616, 437.2432950191571, 405.75210727969346, 460.84980842911875, 417.81570881226054, 434.9597701149425, 471.88122605363986, 499.08199233716476, 447.6183908045977, 407.4900383141762, 408.24176245210725, 456.05670498084294, 456.4593869731801, 444.05172413793105, 477.0590038314176, 470.7842911877395, 464.4639846743295, 437.93716475095783, 429.7103448275862, 452.1026819923372, 431.97816091954024, 438.71302681992336, 471.43869731800766, 479.3168582375479, 446.42030651340997, 437.5455938697318, 447.40421455938696, 408.11417624521073, 364.2919540229885, 359.52107279693485, 398.47318007662835, 393.9942528735632, 383.95900383141765, 379.00613026819923, 397.2383141762452, 366.195785440613, 364.38122605363986, 338.4065134099617, 365.8758620689655, 386.8199233716475, 396.6609195402299, 370.68275862068964, 344.01340996168585, 330.33065134099616, 355.3187739463602, 358.47164750957853, 357.476245210728, 366.7003831417625, 375.6015325670498, 384.25785440613026, 287.44444444444446, 518.4057471264368, 582.5712643678161, 572.0440613026819, 663.5226053639847, 679.2360153256705, 567.2854406130268, 540.636398467433, 455.75632183908044, 433.29616858237546, 489.83486590038314, 481.4310344827586, 529.2053639846744, 578.0781609195402, 483.39885057471264, 440.5743295019157, 425.7823754789272, 452.0432950191571, 415.2103448275862, 442.73869731800767, 471.7007662835249, 492.98927203065136, 459.655938697318, 417.9498084291188, 429.12030651340996, 439.29655172413794, 453.7551724137931, 434.5586206896552, 473.8340996168582, 478.19386973180076, 468.54176245210726, 439.94865900383144, 450.8578544061303, 446.66934865900384, 427.9080459770115, 434.92528735632186, 477.5007662835249, 478.2022988505747, 452.1570881226054, 439.14521072796936, 462.7854406130268, 404.19808429118774, 361.1639846743295, 359.62452107279694, 402.56091954022986, 401.8325670498084, 391.3624521072797, 391.97892720306515, 407.0406130268199, 370.00114942528734, 369.660153256705, 343.5157088122605, 374.8302681992337, 389.53256704980845, 409.4750957854406, 384.308429118774, 359.61494252873564, 333.82107279693486, 358.46360153256705, 374.28773946360155, 367.1513409961686, 377.4302681992337, 396.1670498084291, 399.08620689655174, 305.16513409961686, 493.98314176245214, 558.7272030651341, 556.176245210728, 647.7229885057471, 647.5187739463602, 534.8888888888889, 524.888122605364, 444.88275862068963, 406.74176245210725, 457.98773946360154, 452.9402298850575, 499.77624521072795, 543.0590038314176, 459.67432950191574, 416.11072796934866, 413.86015325670496, 417.0551724137931, 392.9268199233716, 412.4662835249042, 443.33486590038314, 476.9153256704981, 434.68429118773946, 406.63026819923374, 429.0931034482759, 423.0137931034483, 425.26360153256707, 418.5911877394636, 442.28122605363984, 446.416091954023, 443.64942528735634, 416.9352490421456, 453.9996168582376, 419.43793103448274, 402.80114942528735, 404.26743295019156, 442.8536398467433, 442.38850574712643, 435.13486590038315, 422.1609195402299, 459.42873563218393, 378.7011494252874, 347.69386973180076, 340.7157088122605, 390.9199233716475, 389.35095785440615, 379.6180076628352, 381.25632183908044, 407.82758620689657, 355.6854406130268, 345.67394636015325, 331.2854406130268, 364.15900383141764, 374.44750957854404, 399.24750957854405, 381.1521072796935, 362.73716475095785, 330.74789272030654, 354.99655172413793, 355.4651340996169, 366.8524904214559, 377.455938697318, 392.35019157088124, 399.89885057471264, 298.5394636015326, 472.8038314176245, 533.4168582375479, 529.8842911877394, 622.4329501915709, 626.264367816092, 532.4141762452107, 511.5310344827586, 435.56704980842915, 385.58659003831417, 411.13563218390806, 411.3475095785441, 457.42337164750955, 499.9919540229885, 429.592337164751, 389.60536398467434, 386.0360153256705, 386.11954022988505, 354.77662835249043, 363.5593869731801, 402.5402298850575, 431.0942528735632, 405.7743295019157, 375.71417624521075, 403.1655172413793, 390.8536398467433, 370.1659003831418, 370.4011494252874, 403.3544061302682, 403.4593869731801, 407.94367816091955, 390.9605363984674, 430.4, 389.4555555555556, 362.2528735632184, 348.0904214559387, 398.4950191570881, 395.88927203065134, 395.25210727969346, 394.9743295019157, 443.87892720306513, 363.3965517241379, 313.57241379310346, 306.907662835249, 345.944061302682, 348.2367816091954, 360.0348659003831, 366.1528735632184, 404.11149425287357, 343.92413793103447, 332.060153256705, 311.0911877394636, 338.08544061302683, 353.5973180076628, 389.9555555555556, 367.8777777777778, 355.48850574712645, 319.36973180076626, 342.4314176245211, 340.4662835249042, 353.4961685823755, 351.90842911877394, 385.8666666666667, 391.1662835249042, 304.54137931034484, 432.10574712643677, 497.6126436781609, 493.7337164750958, 578.0153256704981, 601.6750957854406, 497.00344827586207, 470.94942528735635, 412.68927203065135, 337.26513409961683, 366.927969348659, 362.7896551724138, 406.4061302681992, 455.2632183908046, 391.2609195402299, 355.932183908046, 357.7808429118774, 341.12068965517244, 304.20344827586206, 317.88582375478927, 348.1536398467433, 391.0344827586207, 365.78582375478925, 334.0272030651341, 375.4302681992337, 347.14444444444445, 325.0494252873563, 313.55632183908045, 353.66053639846746, 349.2996168582375, 371.9199233716475, 345.5195402298851, 415.9613026819923, 355.4766283524904, 313.01685823754786, 300.8390804597701, 334.0195402298851, 343.42030651340997, 347.01302681992337, 364.3670498084291, 412.33486590038314, 330.2800766283525, 284.2145593869732, 271.9080459770115, 301.9961685823755, 304.76360153256707, 323.31111111111113, 341.4747126436782, 386.2704980842912, 314.4114942528736, 299.18275862068964, 278.06628352490424, 301.6137931034483, 322.88352490421454, 362.5038314176245, 345.911877394636, 346.4471264367816, 280.63946360153255, 316.1072796934866, 318.055938697318, 320.83065134099616, 336.9367816091954, 359.50766283524905, 376.3532567049808, 282.2938697318008, 400.11570881226055, 464.92452107279695, 469.82528735632184, 538.9463601532567, 564.1655172413793, 478.239846743295, 462.69808429118774, 377.50689655172414, 310.3222222222222, 321.0636015325671, 316.34674329501917, 359.83639846743296, 410.35555555555555, 347.7, 308.2360153256705, 328.6448275862069, 303.7337164750958, 257.6214559386973, 267.81187739463604, 287.53639846743295, 335.5, 310.1521072796935, 294.6421455938697, 335.31724137931036, 312.03218390804597, 275.2095785440613, 266.20344827586206, 296.5402298850575, 297.26781609195405, 322.5885057471264, 308.84022988505745, 371.3785440613027, 300.05632183908045, 266.82068965517243, 246.17011494252873, 287.460153256705, 293.58697318007665, 306.3134099616858, 318.1448275862069, 383.5444444444444, 307.4352490421456, 236.8551724137931, 223.67509578544062, 260.07969348659003, 262.6486590038314, 284.4567049808429, 302.4471264367816, 360.86436781609194, 275.3877394636015, 268.4095785440613, 240.1785440613027, 267.34444444444443, 285.23716475095785, 325.6662835249042, 317.2919540229885, 321.9593869731801, 252.02145593869733, 279.5183908045977, 279.6122605363985, 284.4605363984674, 295.72337164750957, 336.2501915708812, 347.66053639846746, 262.56130268199234, 378.86551724137934, 416.03563218390804, 428.07088122605364, 515.6735632183908, 533.7842911877394, 436.25210727969346, 444.83716475095787, 353.8134099616858, 275.0252873563218, 282.3961685823755, 275.7888888888889, 307.5053639846743, 352.9670498084291, 296.47816091954024, 275.9689655172414, 300.54597701149424, 263.0544061302682, 206.78697318007661, 214.78275862068966, 236.26436781609195, 281.44291187739464, 258.38122605363986, 244.98697318007663, 296.072030651341, 262.86513409961685, 215.99233716475095, 210.19425287356322, 241.7712643678161, 241.74099616858237, 258.34137931034485, 250.91724137931035, 320.916091954023, 258.7095785440613, 215.27854406130268, 196.36053639846745, 233.4639846743295, 245.11570881226055, 252.4256704980843, 259.17394636015325, 332.5896551724138, 274.40038314176246, 196.50459770114944, 183.26819923371647, 207.25938697318009, 205.94291187739464, 234.6712643678161, 253.40038314176246, 329.8862068965517, 236.0191570881226, 229.3038314176245, 194.19310344827585, 219.90536398467432, 239.14750957854406, 283.5785440613027, 272.6528735632184, 300.11072796934866, 227.6743295019157, 242.50536398467432, 241.9831417624521, 243.06743295019157, 255.97931034482758, 297.0486590038314, 312.3383141762452, 252.28812260536398, 363.5743295019157, 403.6310344827586, 417.1609195402299, 481.9842911877395, 505.41954022988506, 433.548275862069, 419.72681992337164, 341.283908045977, 258.54291187739466, 252.6295019157088, 240.8478927203065, 275.76590038314174, 305.42528735632186, 257.59003831417624, 242.23984674329503, 272.42413793103447, 234.52068965517242, 173.1168582375479, 184.48582375478927, 192.88697318007664, 234.25670498084293, 211.90766283524906, 196.816091954023, 258.77241379310345, 236.5590038314176, 175.79578544061303, 165.84444444444443, 190.85977011494253, 190.83333333333334, 211.32183908045977, 202.2984674329502, 281.41455938697317, 233.8478927203065, 177.32758620689654, 149.06436781609196, 180.96666666666667, 188.42681992337165, 194.98659003831418, 211.7088122605364, 293.05555555555554, 252.05708812260536, 164.06743295019157, 155.35555555555555, 164.12107279693487, 166.71072796934865, 193.1735632183908, 210.39961685823755, 306.76666666666665, 218.92681992337165, 207.36168582375478, 161.427969348659, 183.61609195402298, 196.2624521072797, 247.48505747126435, 241.527969348659, 272.7295019157088, 220.44827586206895, 211.63601532567048, 210.99655172413793, 201.98697318007663, 212.89157088122604, 261.84904214559384, 270.80996168582374, 231.05517241379312, 351.627969348659, 395.5241379310345, 392.8513409961686, 457.18045977011496, 490.22183908045974, 404.89808429118773, 396.8647509578544, 330.4842911877395, 241.2425287356322, 226.1080459770115, 215.17969348659003, 241.11609195402298, 269.3007662835249, 217.93563218390804, 201.8697318007663, 235.16858237547893, 223.84176245210728, 147.44176245210727, 151.55747126436782, 154.772030651341, 192.77241379310345, 168.28122605363984, 162.0337164750958, 217.37011494252874, 225.15057471264367, 161.08122605363985, 139.96934865900383, 152.33141762452107, 148.23869731800767, 173.22452107279693, 166.74674329501914, 252.3329501915709, 216.92107279693488, 160.43716475095786, 131.16053639846743, 143.02375478927203, 147.2455938697318, 153.08275862068965, 182.46743295019158, 255.50574712643677, 225.30689655172415, 149.83869731800766, 128.60344827586206, 135.21417624521072, 140.32490421455938, 165.91226053639846, 179.12911877394637, 282.9314176245211, 202.56819923371648, 184.20344827586206, 138.00459770114944, 151.3911877394636, 169.7425287356322, 213.12145593869732, 218.64022988505747, 240.632183908046, 200.00996168582375, 198.38544061302682, 188.3727969348659, 172.4088122605364, 187.70114942528735, 227.20191570881227, 238.8463601532567, 209.33026819923373, 347.05134099616856, 377.56283524904217, 384.71379310344827, 433.1168582375479, 461.20996168582377, 389.1563218390805, 388.1222222222222, 304.6134099616858, 237.78544061302682, 227.0934865900383, 201.86819923371647, 217.95402298850576, 246.9505747126437, 198.58199233716476, 187.8360153256705, 222.01379310344828, 217.69961685823756, 139.84406130268198, 141.8800766283525, 142.99003831417625, 174.8383141762452, 142.11149425287357, 136.14367816091954, 203.0904214559387, 222.19693486590037, 150.40038314176246, 134.66934865900384, 140.10268199233715, 135.84750957854405, 148.48888888888888, 134.5662835249042, 222.97471264367817, 200.46283524904214, 153.90076628352492, 130.95210727969348, 130.34444444444443, 139.4360153256705, 140.88812260536398, 160.6, 240.26130268199233, 228.2521072796935, 140.29272030651342, 126.22068965517241, 130.89846743295018, 132.15095785440613, 149.57547892720308, 164.7865900383142, 258.70383141762454, 203.4582375478927, 176.74061302681991, 137.0486590038314, 141.444061302682, 161.86858237547892, 203.355938697318, 206.81340996168584, 225.17279693486591, 188.19693486590037, 187.38773946360152, 172.7984674329502, 149.80613026819924, 167.83065134099616, 207.7697318007663, 227.45019157088123, 183.38620689655173, 340.4846743295019, 376.1191570881226, 379.2685823754789, 424.58620689655174, 460.8904214559387, 389.25402298850577, 368.54750957854407, 285.7210727969349, 238.08505747126438, 231.76896551724138, 196.84214559386973, 228.56206896551726, 249.33869731800766, 188.96704980842912, 171.96666666666667, 186.7455938697318, 216.5590038314176, 137.5616858237548, 144.43486590038313, 145.22452107279693, 173.0785440613027, 134.14980842911876, 119.38620689655173, 181.10574712643677, 208.97241379310344, 147.54137931034484, 133.51724137931035, 140.86168582375478, 142.63831417624522, 141.227969348659, 134.17509578544062, 198.14022988505747, 207.0567049808429, 155.44712643678162, 132.74061302681991, 136.12337164750957, 140.98582375478927, 144.52452107279694, 145.46206896551723, 212.28735632183907, 218.45670498084291, 142.46858237547892, 128.5911877394636, 130.86896551724138, 132.1095785440613, 148.1264367816092, 156.2360153256705, 252.8904214559387, 200.2272030651341, 176.76858237547893, 137.63141762452108, 137.82528735632184, 156.39655172413794, 195.59961685823754, 197.21494252873563, 226.7632183908046, 185.86628352490422, 186.0888888888889, 170.50114942528737, 143.82298850574713, 165.2865900383142, 196.73371647509578, 225.05938697318007, 171.82950191570882};

    // Standard deviation array
    double std_deviations[] = {572.6344319507593, 606.3610931062788, 622.4784273643709, 660.2602230028918, 683.9639665632936, 618.1943542455847, 606.7193774048125, 533.3774647242443, 453.29324595566703, 476.8636642070593, 444.7753263299424, 463.29655890928956, 545.7552670147018, 488.14654725879313, 471.54144114235686, 467.80888081024074, 438.61490016420584, 314.7495765019604, 302.1766248848452, 302.18878363835216, 394.33958025131216, 344.40356128308423, 358.8990174287504, 467.93753173843584, 448.97762376341547, 348.792482824356, 298.8451313938401, 294.8673482920218, 301.84332553754166, 350.10073851741, 346.54978605893746, 486.01873822396647, 453.70292558248923, 330.91321007499, 279.3333366084266, 308.81253906631093, 305.86412493099687, 341.1330213952978, 407.96329971410944, 491.3076571485363, 487.88367315176714, 362.85926666311974, 288.50957631036937, 297.88647785306193, 326.05936462078574, 376.97420510483977, 439.93314473201013, 525.0098578848163, 465.8054614600857, 423.44473864940244, 329.6286604350193, 341.0768017705657, 393.04413570073825, 482.3885912576992, 498.1804197158074, 498.775599006503, 457.42156923069894, 460.6692103439359, 423.7870044721706, 365.3519203583666, 406.451307438514, 483.624180798743, 528.0932945978487, 422.33230410674895, 570.1872908386601, 610.820624480127, 619.5407616481581, 660.8993355392414, 695.144188515823, 624.4493933380116, 613.8011475410533, 532.9570707617703, 475.2380591953543, 480.58674336512723, 455.68648662235074, 472.65055375522513, 546.5169610329864, 494.8600290242889, 462.93088648426027, 478.9618895406914, 471.3369010077106, 340.62336809956946, 313.5937286771518, 314.1756860746356, 398.77222888080234, 345.65095648241606, 379.58284957281285, 477.66953598928563, 468.86788662100383, 349.93572470773256, 305.57211812784516, 303.3814180548643, 296.9610886109979, 350.5127764732485, 345.3505128887798, 490.65108064519836, 462.3423760942649, 337.37676031216444, 290.9191369616733, 299.42737509782205, 313.2304528266703, 339.08479844400466, 411.8785172378892, 501.43176910389394, 486.8278401464251, 357.57967996205093, 292.4798470111225, 295.0862356047593, 322.1359537960437, 378.05964661164074, 443.59693420487633, 531.5097329784178, 470.15476765383175, 419.6234472837672, 338.2265606372715, 340.19305913279214, 395.71792929642885, 481.41029353490495, 500.7940161120109, 505.3132196440204, 460.5850361544821, 462.111666437136, 429.8557517387519, 382.2915108069203, 412.07126709307704, 484.26080882230264, 532.9630007915275, 415.7313393483174, 575.214121446924, 618.7298986497703, 622.3748053629598, 670.6502030445782, 695.6985757843552, 633.2200140629104, 623.6934307093896, 542.9221302526389, 491.18556133745193, 498.48476145589194, 490.92245824358764, 507.73640854115564, 565.768648010598, 516.0405177884046, 484.0368715469768, 492.5178643281622, 488.5391131390807, 365.01900990104997, 362.6605078544163, 349.8333391459312, 434.77515356363307, 378.2398051050171, 412.8194673757672, 480.0397888670217, 491.50147447539604, 384.2652322556804, 343.1545256576453, 323.60873618278714, 330.35739424945774, 370.58353484122244, 362.431529507475, 506.675047826298, 473.5622367013905, 373.8329130375336, 311.8507623166217, 320.06280093839564, 330.64707508003204, 353.7728312027914, 433.2139029602588, 513.1062706891023, 501.11700251837726, 374.00062312864543, 321.86396652667287, 327.82378421293885, 345.12872111612535, 380.95759218648436, 444.22831455216954, 539.8231873213898, 485.5937856328719, 434.08533012846544, 359.23871805624816, 349.69801397738485, 400.4906215533309, 486.93864657586175, 492.595095551021, 497.0588025069967, 472.4507203189258, 474.2070229297026, 448.9011876305005, 392.2399805776921, 419.15358731718703, 491.3121352903409, 533.9176192316943, 425.7336585211785, 585.9274937479154, 618.9919194243096, 629.1260543865212, 670.7230566965542, 695.5515751178687, 637.972512456055, 622.6909672546392, 552.5632561638166, 507.9546303704014, 508.002949907327, 502.27399838511064, 513.8018646544027, 574.194070212222, 538.5387311136491, 492.3437626352483, 512.5616619506051, 507.13007814092805, 410.5800683485082, 399.6153441524749, 395.9158043965415, 463.8932340116259, 416.3713491397588, 434.09871661095036, 494.2743982067902, 499.65097331124065, 421.640202906084, 389.54468149828995, 392.4024968729436, 373.81534610272473, 407.4571863477431, 394.4451089090215, 509.24119985472777, 492.090752182574, 406.74328256145554, 366.92969787010844, 372.5344876438688, 381.1459333632468, 392.24684316012593, 443.4756723466026, 520.5012710134745, 514.3595261246813, 402.6251529235101, 350.23974105934803, 361.7093314159127, 358.53094485674524, 403.86910412821817, 460.8451727261519, 543.7223100826772, 495.67530831885546, 437.9688454443595, 378.9362311529836, 368.45046787823935, 418.46780199829936, 489.32380009601917, 503.3654644162803, 502.5862367656897, 479.12116786710004, 480.5918608693868, 456.013600767013, 404.53214403234847, 427.9249199893238, 501.3777493469961, 542.5585533779758, 431.38471181509465, 575.9816239306826, 618.8820593699269, 630.2979408436416, 668.5064707299316, 687.9326134586164, 632.0804156185718, 619.8254845123821, 549.2014234832475, 518.0417032139837, 536.388195337331, 527.6600466556926, 541.4757908309912, 591.4904096479086, 549.8699584907043, 521.049669886956, 511.45043554537466, 515.5255985739644, 432.5434726819387, 437.6926387417542, 439.88359287364796, 490.59531760486504, 454.3280409768242, 464.49652965929727, 509.81069686103183, 512.048865894212, 455.7726569880793, 422.62136896517273, 436.8076599282503, 426.60562825292743, 440.75498464207936, 425.71315939991604, 523.9502351841406, 512.6848346463072, 441.10194892000374, 420.1345473680225, 425.91703389687177, 424.102079131408, 431.7284971471021, 460.5148479475923, 527.6509367160334, 520.7224151115681, 423.9696873835261, 377.79073932751146, 394.04852304782185, 404.3901379649346, 431.8725299198279, 480.3739738877252, 544.112597015491, 503.53577387582993, 465.24820184629175, 390.6234163342951, 394.78270965477805, 438.04693245283806, 499.735818706064, 518.2906494261974, 508.7348312207774, 482.76028038150514, 493.9570642246118, 465.55471486606206, 413.19582894299145, 447.48631846091155, 508.5329071637484, 544.1327109848511, 438.0620991862918, 589.6298208981385, 614.8570497452067, 630.0266593424562, 662.6997270041253, 683.7915209762914, 632.883311713893, 614.0515386888511, 554.8668619003988, 525.3809399478166, 545.306612223243, 546.3921884451672, 558.6482116620549, 598.1489777988539, 568.062927087271, 539.1962291647225, 519.6425498363437, 531.8307696031327, 468.79242091715514, 461.9924746064316, 472.39928795150263, 523.714396624542, 488.16684134892523, 491.539447659666, 529.9842439956155, 521.4340265903811, 471.109064520323, 451.6892414789924, 464.99249825660337, 453.71414636569534, 473.6017177161401, 462.6908676154798, 534.2970619620785, 526.1598356531417, 470.00498309794915, 452.16446403550543, 456.1589745334575, 456.35491461707113, 469.05319632183216, 490.726142155863, 536.1043197902013, 533.7330098881897, 455.3235718996917, 412.4676259168717, 429.705636833254, 439.4716739239962, 459.4987072366087, 494.2209035169537, 555.4224426287556, 511.98346196271007, 486.1988316510004, 424.282672751488, 423.67638051947046, 462.66579046749575, 518.7858356198859, 533.9399630536295, 515.5239500120903, 493.5637826143152, 507.18626854916886, 478.4973917339105, 441.51106775586675, 465.1157588910872, 521.3822140546359, 559.4071781724684, 453.57309465775563, 591.752533391731, 608.9377710535963, 619.0700466312715, 652.3690367903727, 673.6116071390845, 624.9833833607954, 617.3704536125224, 559.2932111233962, 531.7954627150881, 553.6554261161607, 550.1066773617929, 570.4216885265193, 607.3776310163498, 579.7902415916868, 554.3401213819981, 531.7844526659914, 532.7676860668072, 476.32315388498466, 480.58138585956186, 492.8237193738203, 537.5655356999868, 505.6584847439841, 503.9582213701252, 539.913677109913, 526.8913965426641, 485.03843047146125, 473.3522919737052, 479.6418443834985, 475.8577045846281, 494.8379044401345, 486.8503776847235, 549.8503359346547, 526.8852417772505, 484.94770171287865, 469.29889941310904, 475.10084430380425, 478.73601172576593, 489.00689052680286, 511.57540288276357, 553.6863853911681, 532.932748841957, 463.8673668755482, 437.8093780772864, 448.9900622633148, 463.01949145708744, 488.36221055548435, 521.0166286884012, 560.5658113950909, 518.3664237088716, 494.58824633205234, 443.9432927560688, 448.40200649442164, 485.96376807255257, 534.7156203762235, 546.6844063721153, 526.6460994183194, 509.1734175160512, 517.1313824439175, 494.07888131207187, 465.053047939708, 491.61958565396486, 536.7862788888417, 566.2957290594617, 465.2785282160208, 583.1934014277147, 599.8279578266362, 611.5691705448986, 643.0935591322084, 662.9565531789732, 625.2708974090544, 609.7972280792807, 562.0628053199109, 534.8675453684812, 561.1028060694606, 556.9619743448433, 578.8329285755341, 612.629045236771, 582.9535959726737, 567.5109867378023, 545.2983408257653, 532.6154420348373, 493.15720755709464, 502.2803585972482, 506.4819505471943, 550.052757502294, 527.8130992490395, 524.4011551947232, 547.3430718669802, 525.80735406102, 503.84414918007803, 496.1519637531093, 495.36944582048835, 491.9927273123241, 518.7781329989471, 509.7269258960395, 556.5264270305167, 533.8451472337517, 493.99554305364137, 487.8301490524246, 493.956118653181, 497.72085677611113, 508.8685463282226, 530.6735951216972, 564.4122374317519, 539.6969490273125, 481.2762221018496, 460.2147580807154, 480.09383807619247, 492.08482096147185, 506.6892577131629, 535.8552468761809, 565.583291211318, 523.1063427934421, 504.480915847157, 465.1413625860265, 471.94856333362355, 500.2731773623555, 553.5526678310639, 554.1135500464079, 524.6821682227677, 513.2359306433729, 528.1312818114372, 512.9378794855419, 483.05803540061044, 507.7177140987608, 554.6837313512286, 581.5677388443922, 478.72467771576754, 578.9501503701962, 593.4255802127944, 606.3632085865552, 628.6244881270554, 654.1136245497278, 612.8745386177146, 599.6123663567934, 563.0787543580913, 526.9701250023567, 560.6925305662086, 558.5175998486816, 580.9304343653706, 608.4821783271308, 587.8626913943782, 572.0845301427072, 547.261848585475, 534.2758203301796, 491.87174170242247, 502.14290656714303, 517.3160508041542, 550.6427046834514, 529.9740436407783, 530.0222708164234, 549.2323315576689, 530.0644305680461, 500.5635123506319, 494.5449407631257, 503.19851127865735, 502.8327331048437, 523.9459986921502, 521.2596748714725, 561.5685609715241, 538.0914425810633, 502.6874893548438, 493.1133440292877, 504.244475807367, 503.98835223524407, 518.5080592245469, 542.7322478767104, 564.0615116871904, 539.8666701134557, 491.5463863164542, 470.20805726527965, 486.6460905592324, 503.12631256323334, 515.4815081665556, 539.2852639898541, 567.9559416359534, 526.9458908277198, 513.5469714372811, 477.0741139259311, 481.16159997752794, 516.7616691971529, 559.7048413464088, 560.3764450294655, 526.4326225883775, 517.1805640359677, 528.9048030859449, 516.3020793829651, 492.51845603916433, 521.2066718079873, 557.7757002581034, 588.263872487926, 477.7943564841705, 575.0565371886775, 590.0960903778674, 602.3334725736125, 625.9216945159923, 647.2225996256506, 605.0334860268083, 594.8485625522582, 560.3728170793884, 523.6445115850502, 553.8234202597721, 550.5101551516725, 579.320509258905, 608.1964347448119, 585.2503396140405, 566.835839692608, 549.0328426460375, 524.7376922251019, 493.06900978690305, 500.9116511817251, 518.4465593818665, 549.8763039076113, 536.6969313652484, 531.701058319434, 546.0726175334946, 521.6793225330016, 503.8097540480471, 502.3558431132798, 499.9845349766989, 495.9532728715551, 531.226960145713, 527.7045802540282, 554.3240006612347, 533.7137323295121, 509.45311514853734, 504.6160423663161, 503.0940912322324, 513.9049664513722, 526.4887979595744, 546.3734022300995, 567.6954840970905, 544.4941242397398, 496.91776709358055, 476.64502536717856, 497.0068034651572, 509.9210527558152, 530.8308937721275, 552.4499186406836, 566.8383755292481, 529.3270197637461, 516.2745481551713, 476.15579394861106, 487.6643166556267, 521.6173820367818, 563.0937587942386, 565.3478105268347, 530.5560021973953, 513.2753249982568, 529.0737343611323, 520.1965154760052, 500.5039893002271, 524.9350690369563, 559.8435330104206, 590.3903700659935, 482.5800933839257, 576.0333986544861, 597.2190672358417, 599.4240172571765, 625.3395280574118, 644.5414576712031, 601.265366965504, 594.3064240342112, 562.9119491181852, 519.6087417163792, 547.4973055190798, 552.4843612100603, 578.6811713331607, 609.0732052633722, 581.5229818898921, 556.2912341529675, 553.9492142335005, 523.1893901564563, 487.4656358929412, 503.7778275559578, 513.2639247367716, 545.9080528658294, 534.6744642969638, 531.4358301263746, 550.803458498727, 514.1197947930726, 504.23732650287144, 495.2275244468395, 496.64806304938185, 501.94608932710327, 525.818330276847, 528.232353786025, 561.3648516364983, 530.7142522013273, 508.1518364253595, 495.84835867547514, 506.5130765762201, 508.47569108447465, 528.535757876393, 544.6299372684326, 567.3878189616269, 541.2079750492101, 492.1955611614495, 473.451303912551, 490.5697792952345, 505.716494802802, 532.0138365384087, 552.1066009292532, 571.0514627099958, 530.4019039296196, 516.4098603736805, 475.87229518444803, 490.6127608947831, 518.3056605437064, 567.4257960774339, 568.2191723797996, 536.7023826257756, 513.518275925204, 529.5280863835471, 525.4373135424491, 500.18513860504044, 524.9336852147213, 564.809945034673, 590.2284127000405, 493.6185583624748, 576.4574682859263, 596.8743412324566, 600.6291417109992, 632.6339988661193, 652.4874366694914, 596.77475543719, 596.3095680042458, 560.304616837212, 513.9254108811747, 540.3194448950284, 552.0570486220428, 570.3522993169162, 603.6086426265066, 577.3519485398729, 552.5243702257302, 550.762697909368, 510.1540523305303, 479.30748616330413, 493.20385204071243, 502.80139484104535, 543.9036004171447, 526.5007864246013, 530.9278454663109, 557.4585015827818, 516.7707842824624, 498.8849838048407, 491.732578787615, 487.47215406475794, 491.2428128705679, 514.6507628952977, 518.8139620566683, 567.4260506782879, 528.0069706831267, 496.86780074412485, 487.90672406874506, 495.36776774634876, 499.5378193603868, 520.4014985972113, 538.3265187333503, 572.0488917711164, 531.2784417976936, 486.7414666189891, 465.33221974636155, 489.9352292260435, 509.6120169924049, 524.2722626869082, 548.4271971929855, 569.6543908921935, 522.6053266942212, 502.9834856061104, 471.16639744278456, 486.34549117550904, 512.2202289577872, 563.6959875014328, 570.409092495967, 537.5474587245608, 512.5841630224086, 528.8796185768211, 511.6527218614208, 501.1485835178994, 527.0964663514742, 562.7257540762903, 592.1824532760385, 488.93589298235776, 578.4027556338091, 603.3943686845646, 605.3656154539361, 638.9780660366761, 659.3170341843114, 606.0572166998563, 599.071093199596, 560.3662933020456, 510.10714633272215, 528.7458101918933, 540.1656272918436, 562.0655635848386, 600.8906425491067, 573.1396633088275, 545.6188252800331, 538.6831825077606, 503.0461495946578, 464.7251578377583, 473.0734446373841, 490.4120662684694, 530.3287518003599, 519.1166177901935, 523.4205091662843, 552.9012301534445, 508.70712621756076, 475.6470378978207, 469.79510859520616, 474.40023081149104, 481.60908385667324, 504.75447266048303, 512.982221665923, 559.544463872004, 520.7676375466117, 480.5959658747816, 458.34374603032353, 481.3173471551895, 481.3893116267874, 507.4566482487752, 532.0424907699608, 572.000668401465, 530.2587319633299, 470.243572987786, 441.87400760882593, 465.186741159457, 482.06343347754074, 517.6013509975452, 544.4507788368328, 570.3999640486104, 525.4451748687385, 500.3129769710626, 459.67760245437904, 479.11466802185754, 503.8353421738677, 563.0592446334756, 561.1240374862497, 532.6757958718688, 510.1007721824719, 521.8537537621195, 509.6330065386471, 497.1628049070258, 516.8838398279735, 562.1227254500861, 590.9979344775123, 494.0164438105129, 574.8454447669125, 603.7267794992879, 609.793929746697, 645.324982546358, 668.0734417382757, 607.5365063117766, 591.9005169479675, 558.9918864515183, 494.9345165584238, 516.7544517408251, 526.2864892640447, 547.5479067204902, 595.5147077231143, 563.0683506939255, 534.7853026421449, 532.2745865576103, 488.93959737216164, 439.0226383680045, 446.348590631158, 466.2607904066774, 515.5715679930545, 500.46301905223805, 504.3176312665991, 545.0691593114539, 496.4336329588653, 453.5130131679757, 434.9349712351599, 452.2440823845234, 453.9975761153656, 490.64994828151475, 492.4383157603675, 563.4925514952618, 513.8618450653048, 456.3107872729947, 431.3349848134958, 446.7662421189706, 459.0375680264919, 483.75117315770035, 522.6632962176849, 564.7486937555014, 520.3169253283386, 458.16879380796104, 422.1551493094914, 440.38103666777545, 461.3451891798224, 497.7537810820969, 534.259643433723, 565.8693928307696, 515.361842921954, 485.2227887495515, 440.50784500037844, 453.5747787994908, 490.7575630260511, 553.5279883559333, 555.9795758713899, 532.3115971650599, 489.9102129541702, 511.85752251673296, 499.19247888012, 482.3237077528901, 513.0914710743677, 551.9278495335294, 587.1402491267024, 480.6792430648297, 576.8367641819078, 607.9020647740649, 615.1462188983343, 649.936122558434, 674.184284326174, 612.6719647113548, 602.969781268321, 552.4589325684396, 492.54651685767203, 504.08907693721363, 508.68770884804366, 537.2261755126927, 593.2941140481296, 545.6527372027545, 512.4093694706286, 524.9228659830574, 481.40793430107374, 415.05281019221513, 419.4311220480097, 428.1305853363421, 492.2633669224159, 476.73501503930345, 484.58245160137, 531.3494745540501, 489.3531625913359, 432.0661952444353, 412.36281729995693, 422.5977391655567, 426.7089345966161, 472.5530220428481, 481.2810524890884, 549.6917875519833, 490.8501447936451, 440.0787852151695, 391.3205584811832, 424.98915665948164, 434.40021748276774, 467.1147084136203, 504.45163173169635, 563.2349690849906, 519.5578755415016, 427.7676551171604, 388.18621675903927, 416.9901748356723, 436.72701207151636, 479.9058055755923, 516.2059210736668, 562.1159041068734, 497.3052901124391, 474.18957650673684, 416.3263248162972, 442.5101654110607, 475.3374095821654, 539.2562340402955, 549.281379898389, 524.0015200231745, 477.2611977530112, 495.2814508561384, 482.37454629656133, 465.5819060894368, 494.8133965679534, 547.9213732588917, 582.7522600915914, 474.5015092255311, 575.2809654369603, 599.2932886799118, 608.8970110549379, 657.5523019787058, 682.6380139337462, 607.4142249375453, 609.8411261592479, 548.7470989391372, 481.8970138189273, 491.37477108192917, 491.3977424203876, 523.7244531667305, 576.764098196069, 532.4491561916357, 510.49252173334827, 522.3286354793025, 464.0621227216824, 379.7382409385026, 385.39766586236624, 396.6593902482455, 468.5234064303833, 449.4854400277769, 457.0637058965921, 514.619492082751, 466.9634756148658, 392.1064275372103, 372.064351185261, 386.60322628835144, 390.6995645956786, 435.3400664979972, 445.1013265001129, 535.5340667386163, 477.58219763944425, 401.87252248556973, 353.7698213367008, 390.6968188486462, 404.2663147952565, 435.82325413284366, 477.258216264221, 548.363655494172, 507.0198038102574, 403.819873943678, 354.5317943475178, 377.6625109565413, 395.0919862308753, 449.87287346283915, 493.9876681878732, 554.665697944642, 477.7420371279215, 454.3188476712197, 382.48629388503434, 412.0771240655373, 447.8910873567865, 521.9025012800041, 529.7767452519507, 524.9748860986932, 467.0172883080169, 482.3509042168511, 462.68559588055047, 444.54090577666295, 476.62852386686745, 533.1758585117432, 572.8330610323721, 477.11918048603235, 577.5363066260802, 604.6926015824142, 617.4517265675917, 658.9737755920065, 683.632687332211, 618.0165593192571, 609.9456141268408, 553.2157022951836, 479.00482471988835, 478.19644752408624, 475.87078102676463, 513.8197232810535, 558.9254900448291, 516.3791136554022, 497.34200858968524, 520.3145708838696, 449.09953132411493, 359.1791500394748, 368.18902877482, 360.7549925081758, 439.8013283654959, 419.19496499470637, 423.56509889006907, 504.231522878418, 454.2604243257233, 361.43748666103613, 329.9365554038248, 350.2356079867706, 349.25438505325485, 401.4632831081494, 413.80574342639375, 519.4710245835604, 466.3077735773065, 368.76688111956133, 305.71784451432563, 347.5533190991826, 362.1911745798439, 386.78648090711505, 443.34422624994676, 532.7733608221256, 500.07854574392616, 372.3178441358843, 331.01802803311017, 336.31883120426653, 356.7782479880199, 420.2799233095864, 466.19205183621, 548.6924341723765, 471.52737191044207, 441.4312356981907, 354.8126120069176, 381.4258223804425, 413.8029503200817, 507.22834713457615, 519.5957810206864, 516.2253076032757, 469.546764230901, 464.29675500756963, 440.57608010829216, 414.2395255219273, 446.7480284084132, 519.3833451354244, 555.3522397952423, 467.2461066280487, 574.631508031289, 608.3333311224407, 611.9666915285075, 658.3852020897972, 686.8252814672144, 614.095142481455, 606.9310177044488, 557.3861541597698, 468.21352231913846, 464.86160158974224, 459.36933058977297, 489.9017681753716, 546.360003310824, 487.31751675915484, 470.9153407205819, 492.7403588454624, 444.7718583671422, 326.6540882212911, 331.2963900166283, 329.71111665178836, 412.4244739003147, 380.2827520235692, 393.30458741293313, 475.305144361292, 450.5262277880801, 354.5744320803276, 300.0283559701746, 313.2696770284349, 310.08158380893906, 369.41347756461164, 381.7101805227118, 504.90061525983884, 455.29330857770213, 360.50005935509427, 290.94514876871455, 309.43710390770923, 314.9040804968018, 348.8740334781336, 418.96802140781074, 512.0429805706206, 479.6279541445453, 361.65181128004104, 294.802417480071, 302.3596721950785, 331.2683049124232, 394.30651229103466, 444.08450210986416, 539.4577789748311, 462.0697664894921, 422.3577377162623, 326.41988446635685, 347.30821031061737, 392.7807598131931, 481.3547725422708, 508.3027702045783, 499.41679661578644, 456.060375171038, 458.10657723925266, 421.89450492152866, 386.74409886465656, 425.4834558766444, 498.9919964155252, 539.1617914080501, 457.51621427575157, 575.2662562356111, 601.5255676227227, 613.4303806290619, 652.9548925524159, 683.8644874111714, 616.5962197166365, 609.4709903899138, 546.3352313652314, 468.5022944888114, 473.17659910677094, 446.8423563638731, 480.70893627123115, 536.5443705247641, 475.554112352465, 470.14023089984454, 490.5529695167529, 440.4209169640676, 317.2803415699186, 323.20145519094126, 320.6501272654109, 401.46552495504045, 352.4986315862531, 359.93510117483055, 470.47143498230065, 450.6486107956629, 340.25968255250933, 302.8647078857448, 305.6674328330099, 298.6850025857674, 345.68689583663934, 349.10472307813285, 485.63532442159396, 439.0129633075937, 357.0709821887686, 295.81865951201036, 290.51408743445035, 314.60937515080724, 340.91563845168474, 407.89841553337277, 507.00238491642887, 486.7208126521193, 344.31244407138166, 300.25387015843484, 302.0239606933534, 320.57169748287487, 380.8731125031482, 433.25371511304246, 527.4983830164193, 467.0677184519203, 417.2347425844923, 330.50590550094364, 336.24367323475747, 388.02086087803883, 477.3266672353473, 505.75552683447876, 491.9977763198442, 448.650626848384, 446.20113053624686, 406.76820100188536, 358.2944410339487, 403.6068860258314, 482.0055319187854, 535.5020940480516, 439.1719606230454, 572.0018928936652, 604.205074147299, 611.131473938481, 652.3610273470674, 686.5762931993409, 617.8685611389924, 604.4455388442069, 539.8377139925086, 470.63760904622944, 483.25144834949026, 443.3227148343707, 498.8356475188658, 538.5563904246876, 473.2187578530849, 455.1967660515118, 461.597773636507, 441.72421113456744, 315.52148925157775, 326.35898565843286, 326.7119828001881, 400.7248895761899, 341.69201275479514, 339.5101952568045, 453.2417481919945, 435.7343271268656, 336.0898871915473, 298.4559702499359, 310.63343087756544, 311.6267886274565, 337.0922423176516, 353.31767964740686, 465.79376517572183, 447.34293102045376, 357.49088952485937, 303.9478235843994, 303.4556771553753, 314.2066641056213, 346.6034982958206, 379.4074744954283, 483.11198438560353, 478.4717063693938, 348.69565159613285, 303.2854482838484, 301.0821944433235, 320.63147025312503, 380.3322495254194, 422.4865195947615, 526.2455164161479, 462.87398228303203, 415.8262891734025, 330.31176578267, 325.75845265394435, 377.8651103202104, 469.4036244873334, 495.9396825645615, 496.2373565637839, 447.44574290954387, 445.3926449670217, 408.2794975050425, 352.29742540447893, 404.88853280429925, 473.73110206364225, 535.2571580173586, 428.7619632406472};

// Globals, used for compatibility with Arduino-style sketches.
namespace {
const tflite::Model* model = nullptr;
tflite::MicroInterpreter* interpreter = nullptr;
TfLiteTensor* model_input = nullptr;
int input_length;

// Create an area of memory to use for input, output, and intermediate arrays.
// The size of this will depend on the model you're using, and may need to be
// determined by experimentation.
constexpr int kTensorArenaSize = 7 * 1024 + 1008 ;
uint8_t tensor_arena[kTensorArenaSize];
}  // namespace

#include <SD.h>
#include <SPI.h>
#include "FS.h"

SPIClass sdspi = SPIClass();

// A buffer holding the last 200 sets of 3-channel values
const int RING_BUFFER_SIZE = 1920;
float save_data[RING_BUFFER_SIZE] = {0.0};
// Most recent position in the save_data buffer
int begin_index = 0;
// True if there is not yet enough data to run inference
bool pending_initial_data = true;

// The name of this function is important for Arduino compatibility.
void setup() {
  Serial.begin(115200);
  delay(2000);

  // Map the model into a usable data structure. This doesn't involve any
  // copying or parsing, it's a very lightweight operation.
  model = tflite::GetModel(get_model_data());
  if (model->version() != TFLITE_SCHEMA_VERSION) {
    Serial.printf("Model provided is schema version %d not equal "
                         "to supported version %d.",
                         model->version(), TFLITE_SCHEMA_VERSION);
    return;
  }

  // This imports all operations, which is more intensive, than just importing the ones we need.
  // If we ever run out of storage with a model, we can check here to free some space
  static tflite::AllOpsResolver resolver;

  // Build an interpreter to run the model with.
  static tflite::MicroInterpreter static_interpreter(
      model, resolver, tensor_arena, kTensorArenaSize);
  interpreter = &static_interpreter;

  // Allocate memory from the tensor_arena for the model's tensors.
  interpreter->AllocateTensors();

  // Obtain pointer to the model's input tensor.
  model_input = interpreter->input(0);
  if ((model_input->dims->size != 3) || (model_input->dims->data[0] != 1) ||
      (model_input->dims->data[1] != kFrameNumber) ||
      (model_input->dims->data[2] != kChannelNumber) || 
      (model_input->type != kTfLiteFloat32)) {
    Serial.println(model_input->dims->size);
    Serial.println(model_input->dims->data[0]);
    Serial.println(model_input->dims->data[1]);
    Serial.println(model_input->dims->data[2]);
    Serial.println(model_input->type);
    Serial.println("Bad input tensor parameters in model");
    return;
  }

  input_length = model_input->bytes / sizeof(float);
  Serial.printf("input_length: %i \n", input_length);

  // sdcard
  pinMode(SD_ENABLE,OUTPUT);
  digitalWrite(SD_ENABLE,LOW);
  sdspi.begin(VSPI_SCLK,VSPI_MISO,VSPI_MOSI,VSPI_SS);
  SD.begin(VSPI_SS,sdspi);
  
  File file = SD.open("/Data.txt");
  if(!file){
      Serial.println("Failed to open file for reading");
      return;
  }

  Serial.print("Read from file: ");
  while(file.available()){
    String line = file.readStringUntil('\n');
    bool got_data =
      ReadVL53L8CX(model_input->data.f, input_length, false, line);
    // If there was no new data, wait until next time.
    if (got_data) RecognizeManeuvers();
  }
  file.close();
}

// This is the regular function we run to recognize Maneuvers from a pretrained
// model.
void RecognizeManeuvers() {
    // Run inference, and report any error.
    TfLiteStatus invoke_status = interpreter->Invoke();
    if (invoke_status != kTfLiteOk) {
        Serial.printf("Invoke failed");
        return;
    }
    const float* prediction_scores = interpreter->output(0)->data.f;
    File file = SD.open("/Output.txt", FILE_APPEND);
    if(!file){
        Serial.println("Failed to open file for writing");
        return;
    }
    file.println(prediction_scores[0]);
    file.close();
    Serial.println(prediction_scores[0]);
}
long currentTime = 0;
void loop() { 

}

bool ReadVL53L8CX(float* input,
                       int length, bool reset_buffer, String line) {
                        // Clear the buffer if required, e.g. after a successful prediction
  if (reset_buffer) {
    memset(save_data, 0, RING_BUFFER_SIZE * sizeof(float)*64);
    begin_index = 0;
    pending_initial_data = true;
  }
    
  // Parse the line and extract integers
  int index = 0;
  char *token = strtok(const_cast<char*>(line.c_str()), ",");
  while (token != NULL && index < 64) {
    save_data[begin_index++] = atoi(token);
    token = strtok(NULL, ",");
  }

  if (begin_index >= (1400)) {
    begin_index = 0;
    // Check if we are ready for prediction or still pending more initial data
    if (pending_initial_data) {
      pending_initial_data = false;
    }
  }

  // Return if we don't have enough data
  if (pending_initial_data) {
    return false;
  }

  // Copy the requested number of bytes to the provided input tensor
  for (int i = 0; i < length; ++i) {
    int ring_array_index = begin_index + i - length;
    if (ring_array_index < 0) {
      ring_array_index += (1400);
    }
    input[i] = (save_data[ring_array_index]-means[i])/std_deviations[i];
    // input[i] = save_data[ring_array_index];
    // Serial.print(input[i]);
    // Serial.print(",");
  }
  // Serial.print("\n");
  return true;

  
  return false;
}
