
#include <Arduino.h>
#include <Wire.h>
#include <vl53l8cx_class.h>

#define DEV_I2C Wire
#define LPN_PIN 4
#define I2C_RST_PIN -1
#define PWREN_PIN 2
VL53L8CX sensor_VL53L8CX_top(&DEV_I2C, LPN_PIN, I2C_RST_PIN);

void measure(void);

VL53L8CX_DetectionThresholds thresholds[VL53L8CX_NB_THRESHOLDS];
const int res = VL53L8CX_RESOLUTION_8X8;

bool EnableAmbient = false;
bool EnableSignal = false;
char report[256];
volatile int interruptCount = 0;

// A buffer holding the last 200 sets of 3-channel values
const int RING_BUFFER_SIZE = 1280;
float save_data[RING_BUFFER_SIZE] = {0.0};
// Most recent position in the save_data buffer
int begin_index = 0;
// True if there is not yet enough data to run inference
bool pending_initial_data = true;
// How often we should save a measurement during downsampling
int sample_every_n;
// The number of measurements since we last saved one
int sample_skip_counter = 1;

// Mean array
double means[] = {300.1665122026568, 349.4967562557924, 359.386468952734, 392.5288847698486, 414.7979610750695, 359.87735557615076, 352.1912264442385, 243.35217794253938, 215.4890330552981, 203.617547111523, 182.13438368860056, 197.36669755946863, 222.88384306456595, 180.30398517145505, 164.4019153537226, 176.62372567191844, 204.19956750077233, 130.2072907012666, 130.49428483163422, 134.59684893419833, 159.40654927401914, 131.49212233549582, 119.76397899289465, 168.343219029966, 193.96200185356813, 137.3110905159098, 128.90114303367315, 132.6521470497374, 134.32035835650294, 139.39048501699105, 119.09545875810936, 187.60766141489034, 185.97652147049737, 129.3036762434353, 113.086499845536, 128.47605807846773, 127.35928328699413, 129.88291628050663, 136.07846771702194, 196.61322211924622, 198.8789002162496, 126.58109360518999, 108.10287303058388, 112.63639172072907, 116.80043249922768, 123.68087735557616, 142.85264133456906, 212.73988260735248, 170.99721964782205, 146.41890639481002, 116.01884460920606, 117.0679641643497, 133.98826073524867, 164.32684584491813, 165.55576150756875, 197.64071671300587, 155.0908248378128, 159.4439295644115, 145.56935434043868, 121.06734630831016, 135.32993512511584, 166.72103799814644, 178.38090824837812, 138.9502625888168, 303.6017917825147, 360.8291628050664, 355.8313253012048, 391.55329008341056, 428.3151065801668, 366.5400061785604, 368.5616311399444, 258.6589434661724, 243.42168674698794, 202.1804139635465, 185.95613222119246, 189.05004633920296, 225.17886932344763, 187.24776027185666, 161.97343219029966, 186.37658325610133, 229.28884769848625, 141.75903614457832, 132.58480074142724, 133.25826382452888, 159.42477602718566, 130.73524868705593, 125.87982700030892, 175.20265678097005, 222.7602718566574, 138.51899907321595, 129.39264751312945, 126.60271856657398, 126.79919678714859, 134.90546802594994, 119.99443929564411, 182.15724436206364, 194.790546802595, 132.48656163113995, 116.96138399752857, 125.29842446709917, 125.62187210379982, 126.52425084955206, 142.69076305220884, 193.6546184738956, 198.9382143960457, 130.05128205128204, 109.43002780352178, 113.25579240037071, 114.76088971269694, 121.9147358665431, 142.42570281124497, 216.33209762125423, 184.97683039851714, 148.45566882916282, 122.23941921532283, 117.3002780352178, 133.73215940685822, 162.17979610750695, 162.9212233549583, 200.2193388940377, 165.08680877355576, 166.84738955823292, 153.7602718566574, 130.96509113376584, 133.8130985480383, 165.89990732159407, 176.57707754093298, 137.34445474204512, 332.8319431572444, 384.65060240963857, 387.90763052208837, 415.9221501390176, 461.404077849861, 397.41859746679023, 376.60302749459373, 273.9626197096077, 257.1603336422614, 225.13407476058077, 213.82082174853258, 218.08032128514057, 248.18381217176398, 204.2913191226444, 175.40593141797962, 204.51961692925548, 255.8835341365462, 171.64195242508495, 162.75687364843992, 157.0, 180.30614766759345, 148.94192153228298, 141.5430954587581, 185.64565956132222, 254.97435897435898, 176.40685820203893, 157.70342910101945, 141.58387395736793, 142.41210997837504, 148.66882916280505, 131.9536607970343, 211.0639481000927, 225.36175471115232, 163.42724745134385, 135.98548038307075, 139.75223972814334, 140.570281124498, 132.76181649675627, 156.19709607661414, 206.64751312944085, 220.0120481927711, 146.64009885696632, 128.93666975594687, 126.9372876119864, 125.3898671609515, 129.59221501390175, 149.21007105344455, 223.5041705282669, 196.3237565647204, 165.0293481618783, 136.01266604881062, 126.4210688909484, 145.34476367006488, 170.0030892801977, 166.89712696941612, 196.35464936669757, 178.31047265987024, 178.98208217485325, 169.83503243744207, 144.07784986098238, 149.2669138090825, 168.78992894655545, 183.78004324992276, 142.81773246833487, 346.3191226444238, 390.13036762434353, 401.50725980846465, 457.17269076305223, 475.7825146740809, 423.52023478529503, 399.8693234476367, 280.73926475131293, 284.18103181958605, 256.7584182885388, 248.3997528575842, 253.94223046030274, 280.54340438677787, 236.92029657089898, 206.85758418288538, 217.7602718566574, 287.155390793945, 200.68767377201112, 201.50509731232623, 197.7408093914118, 220.0831016373185, 174.90485016991042, 174.63762743280816, 204.69725054062403, 281.5223972814334, 212.021624961384, 196.12696941612603, 192.16713005869633, 184.0886623416744, 176.0874266295953, 155.66450417052826, 221.6252703120173, 251.29348161878283, 194.05684275563794, 169.0250231696015, 178.90639481000926, 177.80290392338586, 161.0043249922768, 173.30305838739574, 223.30305838739574, 233.47049737411183, 164.75440222428173, 151.28328699413038, 151.5010812480692, 142.55946864380599, 152.7818968180414, 162.66604881062713, 235.50447945628667, 203.4967562557924, 179.60117392647513, 153.8412109978375, 143.67037380290392, 166.59654000617857, 176.6326845844918, 178.3305529811554, 208.07198022860675, 190.44145814025333, 193.88569663268458, 184.15477293790548, 157.62279888785912, 164.59406858202038, 182.41334569045412, 190.88569663268458, 145.79641643497064, 379.1186283595922, 420.76799505715167, 435.74822366388634, 486.0132839048502, 503.49088662341677, 448.5359901143034, 416.8001235712079, 315.248687055916, 315.9323447636701, 299.64318813716403, 294.07815878900215, 306.140562248996, 328.69941303676245, 267.77788075378436, 240.48285449490268, 237.59623107815878, 316.33518690145195, 237.822984244671, 244.5724436206364, 246.68334877973433, 272.24343527957984, 227.74266295953043, 206.99721964782205, 237.28483163422922, 305.6638863144887, 253.33982082174853, 234.9947482236639, 251.26784059314178, 244.617547111523, 223.36144578313252, 207.96725362990423, 254.11615693543405, 282.4470188446092, 229.37596540006177, 221.68056842755638, 241.0713623725672, 237.1155390793945, 207.0098856966327, 209.30923694779116, 251.24250849552055, 261.5050973123262, 190.08989805375347, 178.86221810318196, 191.12666048810627, 187.63021316033365, 184.14921223354958, 189.40129749768303, 255.49706518381217, 224.47235094223046, 199.51560086499845, 170.99876428792092, 173.44887241272784, 194.9212233549583, 202.25208526413346, 204.66450417052826, 215.0818659252394, 212.5746061167748, 210.78776645041705, 197.4025332097621, 178.0250231696015, 182.047265987025, 201.87859128822984, 212.70064874884153, 168.08680877355576, 409.6184738955823, 452.51869014519616, 464.8035217794254, 524.6845844918134, 546.5628668520235, 462.97003398208216, 440.12388013592835, 327.62681495211615, 350.0531356194007, 346.4887241272783, 336.6660488106271, 348.5993203583565, 376.6292863762743, 309.4278653073834, 281.6808773555762, 268.14210688909486, 346.52950262588814, 283.2873030583874, 296.42971887550203, 301.52023478529503, 320.2795798578931, 271.3982082174853, 253.75718257645968, 273.7732468334878, 341.7862218103182, 294.8538770466481, 282.45381526104416, 301.19369786839667, 293.51807228915663, 275.2252085264133, 247.3314797652147, 283.04788384306454, 316.66419524250847, 269.9592215013902, 267.03707136237256, 287.172999691072, 281.93883225208526, 258.2928637627433, 257.9372876119864, 288.1461229533519, 281.4655545257955, 223.38616002471423, 209.48748841519927, 232.1133765832561, 228.05869632375658, 222.63113994439297, 223.317578004325, 279.350015446401, 238.94624652455977, 225.29008341056533, 198.8325610132839, 205.45814025332098, 228.36422613531047, 234.03645350633303, 233.69725054062403, 239.833796725363, 221.5279579857893, 226.55854185974667, 221.9091751621872, 206.11275872721657, 212.360827927093, 230.18134074760582, 233.74173617547112, 190.83781278962002, 454.4436206363917, 496.81031819586036, 505.58232931726906, 564.9465554525796, 575.4383688600556, 496.51312944084026, 478.96354649366697, 371.58912573370407, 382.90423231387086, 390.5196169292555, 384.7052826691381, 397.9857893110905, 428.6997219647822, 362.58510966944704, 328.501390176089, 299.83008958912575, 385.31479765214704, 329.87735557615076, 342.1970960766142, 348.40871177015754, 373.5375347544022, 323.10843373493975, 296.78683966635776, 300.38461538461536, 379.09576768612914, 341.7720111214087, 334.1251158480074, 348.6490577695397, 345.87890021624963, 325.3691689836268, 295.8517145505097, 324.81464318813715, 348.043249922768, 308.52425084955206, 313.19246215631756, 336.714859437751, 338.317578004325, 307.39882607352484, 297.97497683039853, 327.82020389249305, 304.5474204510349, 257.8541859746679, 252.24096385542168, 278.6468952734013, 270.5712079085573, 265.89372876119864, 260.4902687673772, 307.16064257028114, 266.38801359283286, 254.64843991350014, 232.85696632684585, 246.52672227371022, 258.9848625270312, 272.3305529811554, 259.97497683039853, 257.6385542168675, 246.61940067964164, 256.98764287920915, 246.97899289465553, 241.65554525795488, 242.76150756873648, 258.3759654000618, 262.5860364535063, 212.95613222119246, 467.3552672227371, 511.05746061167747, 524.2968798270003, 597.5798578931109, 613.1637318504788, 535.5335186901452, 494.537843682422, 389.4989187519308, 403.66419524250847, 424.9462465245598, 416.8977448254557, 446.11183194315726, 487.9620018535681, 405.3290083410565, 363.32375656472044, 343.9786839666358, 420.5029348161878, 369.33518690145195, 387.01729996910717, 397.54896509113377, 422.55329008341056, 363.77355576150757, 343.4921223354958, 338.0988569663268, 404.10318195860367, 388.1346926166203, 386.7633611368551, 404.1489033055298, 394.5915971578622, 380.55977757182575, 349.54556688291626, 364.4683348779734, 386.1560086499845, 355.1887550200803, 358.3163422922459, 384.21563175780045, 383.1136855112759, 355.20234785295025, 341.96941612604263, 360.4151992585727, 327.68520234785296, 291.61414890330553, 285.36453506333027, 319.2267531665122, 307.77448254556685, 300.78683966635776, 297.1037998146432, 330.67006487488413, 288.77355576150757, 284.9122644423849, 269.5424776027186, 280.6265060240964, 295.714859437751, 300.48130985480384, 295.0722891566265, 281.8566573988261, 258.906703738029, 278.24343527957984, 281.77448254556685, 269.2233549582947, 272.7089898053753, 284.72968798270006, 295.58449181340745, 227.77818968180415, 483.1371640407785, 528.4346617238183, 547.198640716713, 611.4998455359901, 637.5066419524251, 546.3191226444238, 507.6836577077541, 410.34383688600553, 410.10534445474207, 454.71238801359283, 450.6447327772629, 480.87611986407165, 512.4504170528267, 437.2678405931418, 400.2443620636392, 356.7562557924004, 432.3639172072907, 397.69045412418905, 412.51374729687984, 435.2372567191844, 458.56811862835957, 405.41427247451344, 370.27710843373495, 368.609514983009, 424.96910719802287, 411.1371640407785, 410.85912882298425, 440.70991658943467, 435.7760271856657, 414.18597466790237, 382.1674389867161, 386.43805993203586, 402.328390485017, 381.4250849552054, 391.2474513438369, 423.4936669755947, 426.8934198331789, 391.19246215631756, 370.6623416743899, 391.704046957059, 342.81804139635466, 313.05128205128204, 307.4111831943157, 348.9413036762434, 336.2008032128514, 323.6496756255792, 323.0627123880136, 348.69045412418905, 299.68674698795184, 302.1356194006796, 289.54989187519305, 314.21655854185974, 326.82329317269074, 330.42971887550203, 307.57182576459684, 294.32221192462157, 276.91504479456285, 290.231078158789, 294.36762434352795, 297.8208217485326, 302.5023169601483, 305.50169910410875, 310.5906703738029, 245.3404386777881, 479.0454124189064, 538.613531047266, 556.6821130676552, 619.4884151992586, 639.3663886314489, 537.4599938214396, 516.5464936669756, 419.80815569972196, 417.77293790546804, 460.27587272165584, 458.93821439604574, 508.4609206054989, 534.282360210071, 453.88600556070435, 412.9938214396046, 381.7784986098239, 435.28915662650604, 402.2008032128514, 421.5359901143034, 450.5749150447946, 472.187828236021, 417.28853877046646, 388.9561322211925, 386.91071980228605, 419.5529811553908, 428.26382452888475, 419.3768921841211, 454.03058387395737, 452.32313870868086, 429.6456595613222, 409.48779734321903, 397.99629286376273, 407.81958603645353, 396.6166203274637, 404.77571825764596, 441.5267222737102, 444.4590670373803, 410.3401297497683, 398.22984244670994, 413.3370404695706, 348.56626506024094, 321.0537534754402, 317.6984862527031, 368.3657707754093, 361.80691998764286, 340.39017608897126, 336.4053135619401, 363.5659561322212, 310.82143960457216, 315.04911955514365, 303.5050973123262, 328.5020080321285, 342.4179796107507, 344.93605189990734, 325.99196787148594, 306.8473895582329, 282.26506024096386, 305.28637627432806, 312.58510966944704, 313.1427247451344, 316.093296261971, 327.0142106889095, 328.5424776027186, 258.6957059005252, 475.15168365770774, 536.7670682730924, 536.2591906085883, 630.0345999382143, 634.0475749150448, 546.6805684275564, 528.021624961384, 419.28853877046646, 409.65616311399447, 459.0528266913809, 452.97126969416126, 494.0670373802904, 537.5387704664813, 457.7278344145814, 419.30274945937595, 384.86129131912264, 430.736484399135, 402.8856966326846, 424.87951807228916, 456.36329935125116, 484.2734012974977, 430.8721037998146, 391.56811862835957, 403.8375038616002, 412.12326227988876, 428.11399443929565, 420.09854803830706, 459.8452270620945, 454.77139326536917, 439.30274945937595, 412.075687364844, 419.5551436515292, 407.8813716404078, 394.53568118628357, 410.13592832869944, 446.6385542168675, 443.28266913809085, 419.21624961384, 407.43342601173924, 420.4782205746061, 357.3076923076923, 324.98115539079396, 324.9264751312944, 371.7951807228916, 368.764905776954, 357.60210071053444, 357.41705282669136, 369.8798270003089, 318.19246215631756, 326.2344763670065, 310.9536607970343, 340.03861600247143, 349.2718566573988, 364.09020698177324, 345.22644423849243, 324.183812171764, 289.65214704973744, 312.50942230460305, 322.7160951498301, 322.75193080012355, 327.4309545875811, 344.2449799196787, 347.1970960766142, 268.7951807228916, 460.5826382452888, 518.6617238183503, 512.2245906703738, 602.3422922459067, 609.7936360827927, 523.528266913809, 505.5332097621254, 418.50478838430644, 389.97126969416126, 420.7781896818041, 422.6787148594378, 463.78127896200186, 503.90546802595, 434.466172381835, 393.89465554525793, 380.39882607352484, 402.5301204819277, 376.37658325610136, 397.77355576150757, 426.3314797652147, 450.91133765832564, 418.2211924621563, 370.7111523015137, 398.1915353722583, 392.2218103181959, 391.08063021316036, 392.1723818350324, 426.42693852332405, 433.32869941303676, 425.8072289156627, 398.6876737720111, 419.47142415817115, 389.758109360519, 369.8758109360519, 375.5443311708372, 413.6425702811245, 420.1479765214705, 406.36762434352795, 394.74884151992586, 418.4284831634229, 344.94037689218413, 306.8507877664504, 312.01359283286996, 345.7590361445783, 347.25671918443004, 346.313561940068, 348.6901451961693, 366.18195860364534, 316.8242199567501, 310.14426938523326, 298.52363299351254, 326.5193080012357, 332.9295644114921, 351.6845844918134, 336.0593141797961, 324.5650293481619, 287.01451961692925, 306.0691998764288, 315.10534445474207, 319.78869323447634, 327.7275254865616, 343.6910719802286, 345.76088971269695, 268.98548038307075, 447.2415817114612, 495.44516527649057, 488.75440222428176, 565.7815878900216, 583.9101019462465, 512.9477911646586, 486.7420451034909, 408.1717639789929, 364.3382761816497, 390.0679641643497, 386.67006487488413, 433.1004016064257, 466.0753784368242, 401.03645350633303, 368.3867778807538, 364.34847080630215, 375.82730923694777, 344.0027803521779, 354.8375038616002, 393.3883225208526, 414.0219338894038, 382.85696632684585, 356.33518690145195, 379.4664813098548, 369.85573061476674, 349.8056842755638, 358.8498609823911, 383.00586963237566, 386.42632066728453, 397.3345690454124, 370.8192771084337, 406.74451652764907, 366.9168983626815, 336.9477911646586, 332.3015137472969, 372.91535372258267, 378.9752857584183, 371.1927710843373, 368.05993203583563, 407.7055915971579, 331.7126969416126, 289.0509731232623, 289.8078467717022, 315.78992894655545, 327.0679641643497, 324.84708063021316, 334.7133147976522, 364.40654927401914, 304.4059314179796, 292.5205437133148, 284.8109360518999, 306.3670064874884, 321.2557924003707, 344.69879518072287, 326.0868087735558, 317.17763361136855, 277.96787148594376, 294.8152610441767, 301.5733704046957, 310.35063330244054, 312.86252703120175, 330.9647822057461, 336.06456595613224, 260.0704355885079, 410.2931726907631, 460.54772937905466, 474.7516218721038, 546.6354649366698, 559.1075069508804, 483.56811862835957, 466.7741736175471, 376.88260735248684, 322.7031201729997, 349.82545566882914, 351.05993203583563, 391.1164658634538, 425.3586654309546, 377.31943157244365, 334.30058696323755, 344.90639481000926, 338.4825455668829, 300.7287611986407, 317.62125424776025, 342.3113994439296, 377.1927710843373, 346.88291628050666, 320.94748223663885, 350.87519308001237, 331.6901451961693, 308.8659252394192, 308.4603027494594, 340.5946864380599, 340.4306456595613, 355.1263515600865, 336.2721655854186, 377.9990732159407, 330.0586963237566, 299.2224281742354, 288.63330244053134, 329.2925548347235, 328.3185047883843, 328.7170219338894, 329.4630831016373, 379.29749768303986, 306.8390485016991, 262.5279579857893, 254.44362063639173, 275.37627432808154, 283.9731232622799, 290.9570590052518, 302.2106889094841, 346.26382452888475, 274.3296261970961, 273.53290083410565, 253.41890639481002, 275.4173617547112, 290.44516527649057, 314.89033055298114, 298.81031819586036, 300.87859128822987, 253.46740809391412, 277.9626197096077, 282.21624961384, 288.98887859128826, 295.058078467717, 314.5804757491504, 318.2916280506642, 244.45010812480692, 376.8226753166512, 429.32035835650294, 434.0698177324683, 502.25949953660796, 514.6385542168674, 451.7874575223973, 439.5647204201421, 362.2514674080939, 290.45381526104416, 308.61044176706827, 304.38585109669447, 340.241890639481, 374.5906703738029, 327.1158480074143, 294.17979610750695, 309.21223354958295, 293.0006178560395, 252.59097930182267, 267.16898362681496, 290.3333333333333, 327.0559159715786, 297.99196787148594, 275.33951189372874, 319.3080012357121, 290.0895891257337, 266.08032128514054, 258.55885078776646, 284.93975903614455, 284.0302749459376, 300.97683039851717, 287.82143960457216, 336.99691071980226, 285.02656780970034, 245.74482545566883, 237.74420759962928, 273.2307692307692, 281.59128822984246, 276.6231078158789, 283.71424158171146, 342.17454433117086, 277.982391102873, 218.17021933889404, 210.6416434970652, 231.9008341056534, 243.1998764287921, 250.58171146122953, 265.2978066110596, 318.6132221192462, 246.72907012666047, 233.40438677788075, 217.4340438677788, 237.6987951807229, 248.6641952425085, 287.4315724436206, 270.67191844300277, 279.8430645659561, 228.02564102564102, 238.87086808773554, 256.1146122953352, 248.71115230151375, 256.15353722582637, 283.5409329626197, 293.26660488106273, 229.90670373802905, 344.97991967871485, 392.61940067964167, 400.198640716713, 472.02224281742355, 490.71424158171146, 419.9956750077232, 413.7599629286376, 336.86005560704353, 269.4782205746061, 258.4655545257955, 259.6336113685511, 293.41087426629593, 333.0605498918752, 275.4093296261971, 258.0704355885079, 277.37627432808154, 258.3713314797652, 204.8940376892184, 214.5063330244053, 237.68056842755638, 270.2721655854186, 248.0985480383071, 227.375656472042, 285.7593450725981, 260.343219029966, 211.6231078158789, 206.00926784059314, 227.97374111831942, 235.25764596848933, 243.79425393883224, 238.76397899289466, 298.8983626814952, 245.32128514056225, 207.09206054989187, 188.37967253629904, 220.8585109669447, 228.6768612913191, 231.18412109978374, 240.15137472968797, 305.75193080012355, 253.30182267531666, 178.2298424467099, 165.9545875810936, 190.58943466172383, 191.1977139326537, 208.05993203583566, 226.85696632684585, 296.3799814643188, 224.31881371640407, 205.24343527957987, 174.77880753784368, 197.0886623416744, 207.5820203892493, 245.36577077540932, 237.96509113376584, 255.06981773246832, 205.91658943466172, 209.8606734630831, 216.55452579548964, 209.40593141797962, 221.2817423540315, 251.9125733704047, 263.3042940994748, 213.71640407784986, 332.6731541550819, 371.6382452888477, 380.978375038616, 437.4253938832252, 462.24467099165895, 402.0685820203893, 396.26506024096386, 307.5057151683658, 244.43342601173927, 234.25733704046957, 220.00247142415816, 246.68056842755638, 275.89867160951496, 234.08248378127897, 223.05653382761815, 246.4426938523324, 227.17547111523015, 163.05468025949955, 177.44763670064876, 187.41952425084955, 220.32221192462157, 201.07692307692307, 186.77788075378436, 245.31665122026567, 228.01143033673154, 167.45196169292555, 160.83595922150138, 184.4253938832252, 186.59097930182267, 203.591906085882, 191.27463700957676, 262.45319740500463, 219.08032128514057, 164.54278653073834, 144.99660179178252, 174.56966326845844, 175.6265060240964, 183.34692616620327, 203.59221501390175, 266.33024405313563, 233.0444856348471, 149.42693852332405, 141.21841210997837, 148.29101019462465, 156.2462156317578, 171.76953969725054, 190.72289156626505, 271.8566573988261, 196.99289465554526, 183.51930800123571, 145.3605189990732, 159.06024096385542, 169.82885387704664, 209.98393574297188, 214.36700648748842, 238.8563484708063, 192.0790855730615, 184.6879827000309, 183.16651220265678, 177.6045721346926, 183.51652764905776, 220.24683348779735, 233.3305529811554, 197.37102255174545, 323.6629595304294, 353.8319431572444, 359.5792400370714, 421.8529502625888, 432.74482545566883, 375.6586345381526, 378.3877046648131, 297.39511893728763, 233.81835032437442, 215.42601173926474, 201.0367624343528, 221.4179796107507, 246.95953042940994, 197.89156626506025, 197.16713005869633, 219.77386468952733, 210.92153228297806, 148.35464936669757, 148.94933580475748, 153.95736793327154, 183.20759962928636, 160.6265060240964, 155.6326845844918, 211.01884460920604, 204.63670064874884, 150.74173617547112, 143.29193697868396, 144.0095767686129, 143.58140253320977, 170.24065492740192, 157.79518072289156, 223.87426629595305, 201.9589125733704, 144.397281433426, 119.55359901143034, 134.59962928637628, 139.75872721655855, 146.77262897744825, 165.11708371949337, 232.7299969107198, 210.274328081557, 132.24250849552055, 118.36855112758727, 121.96045721346925, 132.24590670373803, 146.23478529502626, 159.25579240037072, 249.3812171763979, 190.23725671918444, 161.48995983935743, 120.79796107506951, 134.72103799814644, 146.98949644732778, 185.40376892184122, 191.12511584800743, 213.80877355576152, 173.27587272165584, 168.3012048192771, 164.21594068582021, 150.1856657398826, 161.05004633920296, 198.2656780970034, 212.4426938523324, 178.85140562248995, 322.1152301513747, 355.17454433117086, 364.4448563484708, 407.1037998146432, 416.00957676861293, 359.5403151065802, 366.51158480074145, 285.9252394192153, 225.75223972814334, 214.0843373493976, 194.81124497991968, 209.33395118937287, 234.7287611986407, 181.70590052517764, 179.5647204201421, 209.01451961692925, 212.19616929255483, 138.04603027494593, 139.74976830398518, 137.04603027494593, 164.74019153537225, 137.87828236021008, 134.41767068273091, 189.68705591597157, 204.67964164349706, 141.6360827927093, 131.3036762434353, 135.79301822675316, 134.91411801050356, 141.74050046339204, 134.77726289774483, 202.65183812171765, 196.31356194006796, 140.7503861600247, 116.87735557615076, 125.57244362063639, 129.1760889712697, 132.4751312944084, 147.45319740500463, 210.00463392029658, 204.3141797961075, 124.79394501081248, 109.43744207599629, 117.89805375347544, 121.8195860364535, 135.74575223972815, 142.9555143651529, 228.08835341365463, 174.38152610441767, 151.03830707445167, 117.34723509422305, 121.14303367315415, 136.0790855730615, 169.9505715168366, 174.06950880444856, 201.03367315415508, 168.0030892801977, 156.49706518381217, 147.53228297806612, 128.53197405004633, 147.96818041396355, 177.26258881680567, 197.02564102564102, 165.38214396045723, 316.1748532591906, 345.5841828853877, 360.16002471424156, 402.6827309236948, 412.8186592523942, 360.78900216249616, 342.8134074760581, 262.9131912264442, 227.63083101637318, 211.96478220574605, 186.64782205746062, 210.5084955205437, 225.75409329626197, 178.20852641334568, 169.12357120790855, 184.3629904232314, 211.21377818968182, 137.44114921223354, 141.42601173926474, 141.483781278962, 161.83534136546186, 131.98609823911028, 119.00185356811863, 165.8962001853568, 202.1263515600865, 144.94624652455977, 133.02749459375966, 137.2839048501699, 137.05869632375658, 141.93697868396663, 132.3336422613531, 181.73524868705593, 190.59005251776335, 142.25610132839049, 123.1964782205746, 129.6265060240964, 135.27587272165584, 131.9060858819895, 135.01884460920604, 194.3453815261044, 197.66357738646894, 124.64257028112449, 117.21192462156317, 119.44269385233241, 123.02255174544331, 132.95088044485635, 140.3259190608588, 225.2981155390794, 178.75532900834105, 154.56750077232005, 120.1220265678097, 119.1912264442385, 135.24559777571827, 162.77880753784368, 168.99382143960457, 193.21964782205745, 159.0410874266296, 160.47605807846773, 138.34476367006488, 121.77571825764596, 139.3120172999691, 165.65276490577696, 185.53753475440223, 147.35186901451962};

// Standard deviation array
double std_deviations[] = {552.0122571567213, 595.5106985055613, 605.16521883238, 639.5873487578976, 664.5457050415262, 607.3465069638683, 594.8355459551811, 510.88370393736665, 453.1151097750079, 461.5982732535503, 439.3959212112773, 464.2306572152976, 517.2839873897332, 468.36571926363064, 449.7916938351609, 457.0587989076491, 444.7096420861704, 326.77788321374834, 316.5587835404327, 323.49514479821715, 387.9833203076313, 346.968806682925, 352.92810989021524, 439.8577063999361, 438.86188721241825, 348.0398892569787, 316.57926067137157, 314.26994525675383, 322.19123239822363, 349.68848417919565, 332.87396158034176, 462.42581541655863, 440.199504092221, 331.1082785872038, 286.09769086443544, 313.9655100283059, 314.5589824835504, 339.8294419582368, 380.419985651681, 472.54997063421655, 471.48455179929596, 350.2056423823281, 289.07167830880996, 294.89691524124135, 315.09581003631075, 352.05351742422886, 412.0429540182752, 494.47262419991426, 442.1030794184973, 392.7372459033118, 315.66186349286335, 319.6233664805107, 364.4042715719945, 443.35615655599065, 461.7150012845565, 472.0262434759083, 423.7049757634614, 427.4933812375582, 395.6839496068879, 339.60550143881426, 380.324946682818, 446.18786247304115, 487.61646877222694, 395.2033513358638, 549.4797240698873, 597.6855020697056, 603.0143034803733, 637.7202673149789, 669.5327680263377, 609.6807269696029, 601.6588891492967, 520.71016342014, 476.6609272888095, 458.27504905506385, 435.1386996256321, 453.0689726108947, 519.8326034102931, 472.6149379882061, 444.972381920463, 465.61667213569245, 466.4654291363554, 341.4819780289501, 322.5581837253998, 321.7750823351837, 391.7618043897774, 347.25378064258257, 362.46398146569527, 450.1855235104302, 460.4389881152908, 343.76255360302355, 313.4582523707187, 302.14460051752667, 307.63711750988443, 339.70847097133236, 337.4405115365446, 453.09959547954986, 443.4728409268229, 332.2382899818566, 293.27983695752505, 306.9452246519872, 310.0030171016517, 335.03637146249065, 390.602357737627, 468.7859453382043, 464.65397107283974, 351.4752006148651, 288.49166586434393, 295.00493401249815, 311.64003821127193, 348.2239355924033, 412.0565394639696, 497.7154487263297, 456.9265389427503, 394.67338588071107, 325.7398562569709, 318.5463973568042, 365.42174008327464, 440.13886698410084, 458.0962806230296, 475.0430181549248, 431.39188647663127, 433.8556505931126, 402.63852969503955, 354.7854721514199, 375.6933361549129, 445.6816453468379, 486.41417799502227, 391.08033828826456, 564.0497780966332, 605.3182629950895, 612.2654870933636, 642.820202628682, 677.6572683363336, 620.3206027787804, 602.148756349326, 528.7366785826839, 478.57487691734013, 471.0359401448159, 460.30144388106265, 479.02565198531113, 528.1064160414267, 487.411744119753, 452.3810349067663, 480.74960518623806, 482.72621924554926, 375.4607779857188, 350.99600444640026, 344.60702883863564, 409.7838439551452, 369.3485230847215, 380.3566458156357, 457.9998646151477, 478.70586499569583, 384.6188887446405, 344.09948436631026, 318.62751626882346, 321.0143726483273, 357.7943290385437, 349.419806432485, 482.31744134964896, 468.5151877153355, 372.1330702449923, 316.67740627817744, 322.9262870523308, 331.18982255935424, 339.0466077283254, 405.8187497667524, 479.51829423384555, 479.5818074951953, 371.86100031780444, 313.2671921022145, 317.3424188036168, 327.3452073362785, 357.17094714959836, 420.946711369375, 502.9509898957983, 464.5304506763103, 413.27937511364314, 344.53384914979824, 328.50731724922673, 378.70165464722197, 448.9815826166123, 458.52313212624927, 469.7270902831273, 443.6692545898664, 446.2457582850343, 424.3284060753501, 368.5080886829013, 398.02945705421826, 448.4024121783397, 492.16243648156495, 397.1533517672276, 562.0292367332357, 597.7478856087455, 608.8764193171146, 652.8255921559926, 670.5226358267935, 626.2462880707589, 609.6234143796029, 525.6418751293915, 495.3389149769715, 487.15624876889535, 482.0836900259154, 494.1664704573556, 540.9839926526097, 510.18187512075997, 477.73143422397175, 488.0899682493395, 497.94389626766446, 396.8758453079168, 390.85942755906416, 384.71409551984516, 435.42261477632616, 393.19278185014855, 416.17805590388133, 469.828053819876, 489.30999996543244, 410.1336470340954, 380.37420188771284, 374.8738544220806, 366.68671957153737, 386.4204062748546, 369.75858987003693, 485.6869253449185, 483.68170049466227, 398.16335118831915, 356.4934027109562, 364.4186048581601, 367.75543589178795, 369.7094016745816, 414.7863829695705, 489.2955726966327, 483.0255531822628, 388.17616035022974, 340.8180065224233, 345.08608716104595, 342.1359987551782, 381.2004784406869, 431.36261102813165, 508.4620578296959, 463.7314995567672, 424.59688276788614, 364.62471063455075, 347.3593323986006, 399.68736124775694, 448.77763760486295, 465.21719121729785, 479.1290246391413, 450.09448160517314, 457.8374789748859, 436.8840788115858, 383.41370117111666, 412.3843838147206, 458.680358173526, 495.02681382262926, 394.94117331508585, 568.1906452451116, 601.9710141472166, 613.5145772392905, 648.7452094233174, 672.7808191216901, 625.5488106505998, 609.4614008776114, 543.2365309678461, 507.08250545765435, 510.74280556156674, 507.93937206349153, 527.7345047074454, 563.972392039967, 523.4830567931882, 497.90336014035495, 492.5812084500788, 507.12021307616465, 423.50041664046444, 425.5730666425943, 424.2843655742141, 472.89565872253036, 440.59960851743483, 441.32979218794276, 492.1786696664609, 497.83593539352023, 439.22665074547075, 410.13759112624734, 426.70374442437077, 417.8293550583888, 430.1611149723318, 424.05593360441395, 507.6438618684735, 494.76350471607, 425.61715369924707, 407.3817488713577, 419.73475836762105, 420.04294129613777, 411.2660109378744, 444.81036264114715, 505.10088631280325, 500.0118809728043, 410.2074374611332, 375.64628133889784, 385.9719986086793, 394.1089621794636, 412.8142700315755, 452.42122860474905, 521.3357968177475, 477.8764331062187, 439.1005883390387, 382.8147270268274, 382.90020800329484, 422.8753974453741, 469.0356739995598, 486.4332963124154, 480.1073447655709, 465.3035679298773, 468.58524185402547, 442.975130073027, 401.778115756997, 426.9547337740767, 473.4015745143492, 512.2048298721953, 415.31433529094215, 570.8096818279078, 600.7880285186972, 611.7905556470671, 645.2219694454309, 668.7418931354706, 618.2983579685238, 606.4431362605027, 537.2687393072313, 515.6717316616566, 530.6469395882896, 523.2559917187375, 540.9545589251509, 577.2732461529978, 540.4921950548542, 519.0423804398941, 504.3543839896937, 514.0028525975073, 452.91663693761205, 457.1832982505728, 464.2538467325155, 502.9510005792785, 470.1870350378709, 470.1268041385986, 506.36822469574315, 506.55078510316145, 459.76771340372545, 442.7210503639933, 453.7647031147797, 445.9066822669533, 468.0324035867859, 449.46109334137236, 512.2744221500104, 503.73943153601016, 448.03427336228594, 438.9133447208701, 444.5265753101707, 447.3622406111374, 455.1783839877077, 477.6111736552071, 522.1119702211452, 504.94852887058346, 431.74445356603985, 396.85247297754984, 416.6074404830041, 427.2476240260768, 448.2503305575435, 475.29188519169327, 528.8535301560449, 479.40219591220256, 457.3742923638318, 399.75615105366705, 403.80512172249445, 447.45821176403206, 489.48542066764406, 505.75051859352976, 493.0920963076142, 464.4339390661536, 475.0314716193322, 459.1408382281554, 423.61214119421794, 447.4981482584853, 490.6883322483731, 521.9311329430351, 434.6947930789723, 579.0963396343756, 600.0342281286729, 614.9878055883028, 639.1777425071656, 656.4217331863551, 616.6098602091406, 608.5609769620688, 554.5875788537394, 522.9777783626292, 537.98242412153, 533.5380896068935, 551.8413900621258, 584.95320296065, 560.6539596452983, 536.5072184429387, 515.7105665896395, 520.5257721408553, 471.1067836262526, 473.22530549398056, 479.2554815351661, 519.6380250465756, 494.2363937374312, 485.40477200413864, 508.8719611972686, 514.8327904024084, 477.03009483910773, 465.11858245555885, 471.43688406768285, 469.91958919105963, 484.81412884238176, 470.6752958386002, 527.378206671235, 509.07643450747213, 466.21222809672224, 461.47851573038116, 470.29294790318744, 474.1824343120867, 477.2989224676691, 493.1987673221442, 531.2047636110973, 509.09636275581045, 451.8715138761889, 425.78905800629104, 446.93190431360813, 455.8423296305782, 473.4245144816329, 496.96867108313995, 538.9048926362992, 491.69863024911524, 471.7876551732478, 425.05491214259484, 433.44261957087747, 463.9348436571448, 511.50873961627855, 515.8142837681416, 499.86197016878316, 477.262031142853, 491.96238076907116, 467.9680356086415, 446.0149359808469, 462.06819246052066, 505.8458298110791, 533.0780256491358, 447.8093390390682, 571.3620123020532, 591.3256281879269, 604.6149451607996, 631.4278088019012, 649.5891444616716, 615.4956158574195, 600.8948097000177, 552.161891268638, 521.2308257127785, 540.786912377675, 535.879575768798, 561.4461185709068, 595.6086967079467, 567.3019268831412, 544.9047635407076, 533.0832546791121, 524.7743311335428, 481.30789187872523, 491.32828389500025, 495.8743517447418, 529.2058272124324, 507.11143460821563, 509.46776369016334, 523.0383202503868, 514.0387231906949, 492.73035876488206, 486.03565532132535, 490.36584925893203, 486.90367124938894, 508.5067965025566, 497.3619379188125, 539.37969670243, 519.7242621676482, 487.52200481715056, 478.11354085011675, 485.3857398949502, 490.59949902873416, 500.21556998375456, 511.82186415568685, 541.1974811611159, 514.4746927901605, 469.9564296225594, 449.86678557119114, 468.64028846895656, 473.13441108441475, 494.58964899148265, 514.4250423794929, 544.6063585448353, 498.2180724997137, 487.0045121307211, 450.65318790680743, 456.39197752293114, 485.9650332439175, 522.7088458899399, 533.723410915026, 507.7943568943426, 479.4514280552672, 500.06889119870453, 492.24779248854117, 463.7335521480168, 483.2253020858535, 521.1754266023053, 551.4892254745193, 452.79368653301884, 571.3311862703241, 586.1015919867705, 600.8699026200107, 623.8830313765894, 642.2003362579109, 608.2522857922938, 596.1042670615499, 551.6720612075106, 513.1662371855656, 543.4419224033111, 543.1161053923693, 561.0143642322399, 588.071282210013, 571.1435106220988, 556.2098974473705, 528.6124779983222, 517.2577198559243, 485.5960739756448, 494.0748426613448, 500.9453817512868, 535.8011772317849, 514.4279574484417, 517.661277436176, 532.0981111456334, 516.318837618102, 491.4236954083137, 489.8376963086597, 491.072801453475, 491.52555688139506, 511.11924168681554, 505.5606165372594, 542.3042892862425, 519.0060728467555, 490.6243735266258, 487.94720742040414, 494.5328907973409, 499.76474361329645, 507.3010721934746, 517.4858472286995, 549.2581422148481, 517.8298122905578, 478.206663550075, 459.5251520579204, 479.322433565371, 486.49467873430734, 499.96421272364506, 520.9341026331318, 547.9181245294212, 498.4412763929025, 492.6978342176686, 458.9251337675926, 471.6622788397865, 499.1706278426881, 535.868638562266, 532.964992480669, 507.1506838870658, 486.08626832332203, 500.33718477832434, 491.30986509787, 475.2677771714486, 497.51656633313297, 526.1671173835463, 552.2781757334683, 463.1173950580654, 566.2929676009325, 585.3112275487606, 595.6260574706872, 616.5957160501994, 638.6435887453188, 596.4948279111957, 591.039443526182, 550.5203183384956, 513.901098691908, 537.9981770475963, 541.1943877679469, 568.0168842715545, 587.9658424766681, 572.0430886877592, 553.0893933248707, 533.2162443441398, 512.902583382044, 479.7435197653496, 492.9599217145252, 503.11616135892933, 533.5965257875469, 518.0942671010384, 516.1005803248721, 531.0162304571924, 506.52908625166543, 494.4782019595148, 488.56990915283177, 490.40450603596196, 488.6298781913195, 510.36282942812704, 511.064282537925, 536.7899381855635, 516.8664887007802, 494.8145142674757, 490.2017499875981, 494.2431568535342, 501.04956194347795, 509.2434242660538, 527.7188178907539, 548.3177917675796, 515.9815828424554, 475.71923877940327, 463.19964946880145, 484.6763379700046, 496.0671842811867, 504.99300631292044, 522.0756967393916, 548.2548810848979, 499.6753758647969, 495.5647372144871, 465.3490367800237, 475.2167667064771, 504.04471273435735, 536.8968250324428, 535.9698134793842, 508.98685115277186, 485.9949721317952, 505.8818650564737, 498.64308426696124, 483.4414575707234, 499.9644651643774, 532.8513977586917, 555.0135365623788, 466.05572412424567, 566.6431438147738, 587.9512294783706, 591.4443596005192, 621.0134934723246, 637.5950335735427, 597.3912568665406, 591.7302335425392, 547.8283146881388, 512.9203516041821, 536.4329312823509, 541.0946131609018, 563.472065636641, 592.7703155641285, 570.1519759085402, 548.4583717229451, 533.9166265230825, 514.7817369596514, 482.31016254797186, 496.47325593233563, 503.8273902436273, 539.0264536881956, 522.9458361625698, 518.0437491081865, 535.5224302073483, 509.559664958598, 498.9963151177544, 492.6083601268299, 492.2828526364952, 493.297089787083, 512.7892142821147, 513.2041485929581, 545.5903790628432, 519.3989701774656, 496.3262387668862, 494.428769919185, 497.89302842128666, 498.20435624978694, 513.6201398068625, 530.9559808496676, 547.3395851525746, 521.5695098851025, 478.97575880793227, 464.5645070241781, 487.86617125175223, 499.95279112729895, 517.9986198132444, 533.4063792787467, 550.7331862174331, 506.8284318621644, 498.73926288435257, 471.85068791565305, 483.68219132997035, 506.80881725995846, 546.1553538852841, 547.2051631543269, 517.6421788070625, 488.8980871408708, 507.99142564340843, 504.2915817365913, 486.37864522496454, 506.71813750225743, 542.7475242780521, 563.5986183546557, 469.8107668942683, 567.7554757483919, 589.9074741928714, 592.2902261504773, 626.2868106644852, 642.2451309287601, 596.640204582031, 590.988212182365, 552.8904543842352, 509.58716756745633, 526.080176198222, 537.7263769147456, 552.7721172759924, 587.4838061179156, 562.8857927473591, 538.4624402218503, 531.4487692051155, 507.12473348121, 476.7298319787525, 486.28036316739747, 496.35353035900647, 529.391508272633, 516.6690520716447, 504.5114426612655, 537.2248508694865, 505.6070206155204, 485.85455067345663, 482.6706372109466, 480.6827647082844, 488.51454280367557, 506.6602331116557, 506.86790912977176, 545.9289873733347, 520.2254447013171, 487.69258882130373, 480.4474245949935, 487.1758194966147, 495.4056239045388, 509.33147547374097, 526.2447881150699, 550.3814642238734, 517.2460562418897, 468.77719414244814, 458.91682634974796, 471.60157586048314, 487.41245949799287, 510.5666392261747, 527.8674492089784, 546.2640978264143, 505.7778347232709, 487.8019064286389, 457.6489290987627, 476.0063972472879, 496.89446126421956, 539.574057392312, 543.3568293441774, 516.708489511193, 489.55758189029905, 503.0842128394488, 497.3431105639621, 481.2667243995412, 505.19151700429245, 539.0711484974964, 560.7222462325087, 470.72977618423727, 573.2232311650744, 593.9166531524644, 594.8520546046708, 626.4452370535464, 647.0642399538247, 603.1662954049096, 591.18786387637, 553.3458240731775, 500.85835700995375, 517.9488356079744, 527.7460163550143, 548.7170839094351, 582.3032637831952, 552.7242447474978, 529.9952534903521, 525.1454425617269, 500.8526898079084, 464.84834541701946, 464.44705199938, 484.29818991590355, 517.0025462426129, 502.1334566344631, 502.57449564293273, 531.6832566985489, 503.1318890240594, 470.57957244803794, 469.07262869997146, 469.9331297082903, 475.00364230510246, 497.6259290207587, 496.63826415599794, 543.8641392396933, 514.7402608982288, 474.0322115524894, 457.88790332560575, 476.6534115714672, 479.2746037722921, 493.78542906510575, 516.1689973741421, 550.929721802516, 513.6571031829908, 460.0843580187141, 442.09424601596413, 455.3967696867351, 476.27468270442154, 500.5743569552717, 523.9647532981928, 550.001301141819, 501.8374617344106, 479.2019514914402, 452.7494723760053, 464.79673109281526, 492.078720807029, 539.8691409211187, 537.6648472652648, 513.6982807560654, 485.30548827245843, 495.9805662798802, 487.95767686960363, 479.0958870875001, 499.3865572142163, 534.8167185629915, 557.4535070973507, 466.61175057767866, 570.2311404428683, 593.994393469777, 604.6887935217651, 635.0262235185753, 653.7075641458935, 603.4473040952676, 589.7463721101016, 543.6349089588873, 489.47417635967275, 505.5996670170501, 519.8518242500897, 541.0813436238445, 577.434782639446, 551.0499820364994, 518.5759029381227, 524.409240753784, 492.35835730929045, 443.0522736917819, 454.3513559649561, 462.1085754772508, 504.6475726697142, 491.39751175429905, 491.44144909707546, 524.1786825012597, 492.4626653286005, 452.6654829833729, 445.17724396537864, 449.8113586098594, 456.1596409877745, 484.0629506247142, 486.3360487444325, 538.9377385233861, 500.2583820640715, 457.1828261214273, 435.5263593385754, 457.0729853288027, 457.0243633007626, 474.9908041943845, 503.36084891404886, 546.695816594481, 507.17896452100706, 447.7812057852536, 420.09416135617766, 431.013202240933, 454.9731671677686, 483.0592043872258, 508.14225126067726, 543.7811368886508, 486.77033947086835, 473.6963958965117, 434.10998506819243, 450.12197816291064, 477.3143529265391, 524.4677812098072, 525.7892728543237, 506.93433553025835, 471.596236346738, 489.2068323630637, 481.42868956922047, 471.03959903758164, 490.08658962726497, 530.5119828465668, 552.8435440094751, 457.8864438106207, 567.3041229694181, 594.0883610887262, 600.777793213439, 638.0647258576585, 655.1518184303515, 602.6296410966864, 593.3729689559799, 547.1346258717153, 481.8740333122915, 497.70413889732026, 498.8173560867635, 526.1563811368904, 567.1909697088997, 531.4416446548597, 503.47363707643603, 510.82087988854323, 474.7184815238048, 415.01480053578973, 427.4568343674456, 434.4098981761413, 487.7705495561159, 466.41138206732677, 466.1045557236773, 514.4180271723367, 478.0237009191649, 435.5726221301749, 414.7793321257006, 416.1600775533568, 421.72480951721093, 457.44043210296303, 467.21252183541253, 527.4987404855212, 484.52979723645427, 425.94747436663613, 396.78541569946685, 423.35597907876974, 436.1863862724921, 447.51530218288525, 483.7117113224744, 537.4832484066065, 498.3616054365919, 416.47877798062075, 388.9925559970093, 403.86712501798894, 429.8178870488877, 457.2802478748496, 491.1823513001446, 536.1847024504027, 475.86148189568996, 448.8053753627482, 408.9285498749148, 424.70440076315157, 453.18471254279154, 515.5698480112496, 514.0742424157115, 500.58563672588707, 459.9411155148613, 465.77598461884605, 472.585068578346, 448.4650603875922, 468.71048516533426, 516.8608987932679, 544.9105344485253, 453.6204749766597, 559.4586530381916, 591.1043515081219, 597.1037825852718, 640.3586384119862, 664.4042155134547, 601.2421782582527, 598.4133460607728, 545.0527466532831, 482.55949185595256, 472.6460053169656, 480.3316173315108, 513.3206027945798, 563.0270223587445, 514.5641615763981, 495.8608700564105, 507.4086849729672, 464.4693131593481, 384.12247069324394, 396.0770010607587, 407.5023017755226, 459.8368158331695, 444.1767925439759, 439.718698941569, 507.9914854132262, 471.2004197287674, 399.66187987364793, 379.21361639425476, 384.89483045658216, 393.9599208719105, 421.64268363618544, 439.53464722428987, 517.1990841701648, 468.5688310346656, 403.20924386241467, 361.9802128680759, 391.5916710345218, 400.645857175731, 421.5570049135307, 461.3771991917325, 529.2188050812847, 491.762686712826, 386.15548792935857, 343.27492641894423, 373.9360346008658, 387.6620605290686, 431.6045850991953, 469.41174275583927, 534.0615890077715, 470.48482969375664, 438.0155907741168, 372.2593740791553, 396.61817143473894, 423.6540749794646, 491.9061688994761, 500.30793021923284, 494.0396175610431, 447.3902754144504, 453.7654011539882, 449.3435082344013, 421.27666736029, 451.2383643845268, 502.44944607683414, 534.8588602542123, 446.5420912434435, 560.263503309738, 591.3991153351211, 599.6169028454924, 638.0012907252908, 663.2131380075944, 604.2891474561914, 600.8828955108386, 536.5675176548108, 473.11542895407433, 469.14000703047486, 455.8057390915168, 487.59966439474994, 532.9889085468939, 491.0946254052205, 481.01181029982797, 493.5950609759654, 448.27016033735106, 352.19908875834716, 369.8264278955448, 365.8307139955055, 425.7377332659178, 408.4918674347378, 411.3498869218008, 488.76997186585083, 451.45208909466646, 364.6228981086625, 335.4743219168019, 353.2686949720751, 357.51987592232786, 398.66421224715145, 403.2239411983678, 503.3466885111674, 457.55234050911025, 366.81022549454696, 318.71015095552644, 354.7158014908393, 358.6558115781791, 380.7715389920427, 439.685464753971, 511.5215588920372, 485.0659094848372, 364.744653604002, 324.8968765756298, 327.12687152486785, 352.7609951061129, 399.01854728072914, 445.88346919139894, 523.1726063097196, 455.641455398697, 424.25931460756277, 346.7029660100995, 359.68881586013947, 390.59593624867415, 470.7873170756242, 490.8631500383617, 491.5578314905928, 442.89507643984894, 438.6633349483726, 415.68932193712084, 396.4705477431869, 420.8581419503461, 483.30185716009515, 522.0095241013233, 439.3631197592804, 560.3885411474627, 585.0817301961255, 593.5808840957009, 639.9919403078791, 659.9719153239171, 601.2077428083549, 597.4484838846699, 537.2830469015005, 467.47966183154153, 462.15195406579966, 445.4832258203029, 474.44432726143435, 522.9022138697104, 463.59041201048404, 468.0052948453537, 477.0543842504514, 438.9681894895692, 339.7811362217403, 336.89026441829793, 333.15112387122747, 401.4401886357606, 373.4555821098615, 382.77316000198977, 466.0528415451286, 435.4877709285854, 350.9920862009137, 322.88282335072927, 312.8669440088228, 315.2627904815729, 374.79234062096407, 377.2479795325892, 476.8068973598275, 444.72593690316023, 346.5642082152177, 287.9449508188345, 308.3657297241719, 321.89879604985964, 350.5334936910254, 404.7627888504056, 492.39238932540934, 473.53159022780216, 348.8173561109889, 301.26330720022344, 299.70797079793465, 328.2540844809955, 375.605570386212, 418.98050139725405, 513.0311076200471, 456.56500375380875, 402.7087964101544, 315.10163017518937, 334.29249386461055, 369.88503738921855, 453.19805467431866, 478.89384060980933, 476.39941025800067, 428.78010198228, 427.7912383727052, 400.74059569866495, 367.72189638993814, 398.65542856414453, 469.9871357709564, 510.87066479752696, 428.0999920462777, 560.7916962142307, 591.8132085097378, 600.7489871046109, 637.5193848472351, 657.2528645733257, 597.1001088617743, 597.6578234244008, 535.3300143400352, 461.7239476122718, 464.8612337336055, 447.15300952089854, 475.1815151608494, 523.5743028630957, 451.23202232620645, 458.44711886353497, 476.8560266610706, 442.81863587638804, 326.9932720744026, 328.89101313497974, 320.60605074117564, 391.0265200974857, 350.92264199123713, 359.45182550974937, 452.29181202116746, 436.5945392662862, 338.2858264432933, 306.56385085541046, 309.46425215494634, 311.8676923968779, 342.7327023920652, 354.79940440166746, 462.29492163501897, 443.6270126955203, 348.15158331551, 285.1605070305129, 302.5671249150931, 307.87878089008046, 336.4692949171099, 390.20611306893835, 477.6863807171737, 468.4007356356371, 335.55602607639514, 282.87445108441926, 294.3062961794736, 318.967800927456, 371.81205941128616, 404.6019785829491, 500.65389701891223, 438.7027707260495, 391.8506274018438, 311.4593618885919, 318.7351211767392, 359.93121908164534, 442.5926354923957, 468.2525390575075, 470.3704385900767, 429.90717434215003, 414.40764220867266, 381.10634675473517, 338.5370541346187, 386.64644189430754, 452.46153820926935, 500.8267255060296, 420.4295236227088, 559.365809148134, 585.927848822176, 601.830968807792, 638.4858631605498, 660.3194826286832, 603.3740065745687, 588.3084402877838, 521.8081733042657, 464.14877087903125, 462.27040406081625, 432.1622906369879, 477.99375128126917, 513.8628574088258, 455.8114445498252, 452.0025297072571, 459.12200143143855, 440.7397641664331, 325.79144100688256, 328.6883536677681, 327.414568679056, 388.3179132378664, 346.83237424088543, 339.7665019822966, 429.0469372529779, 433.4277133938087, 343.7851321207972, 307.4822460738125, 312.0055943647047, 312.1296875891207, 347.72323209190165, 352.42499499615616, 445.69918279145577, 434.5412073195412, 348.0781103824277, 297.29473025739514, 305.7320700969285, 319.10358817038195, 336.576725759777, 369.9155677907304, 462.8736181345662, 462.81118100188166, 328.76545620587734, 303.41919533873096, 299.88422161925195, 322.9410507498448, 366.63847724509077, 403.3019051251802, 501.6454670808122, 443.2755768322149, 396.95692029643845, 315.8414893595138, 312.47691573970394, 361.79031870406845, 435.18099225830343, 463.9168562510741, 463.43923603418887, 421.2544902394722, 422.1522694282371, 370.5339179909931, 329.1442519265547, 376.3585351038057, 438.5222734114645, 492.1184567123927, 400.3569947794428};

bool SetupVL53L8CX() {
  // Enable PWREN pin if present
  if (PWREN_PIN >= 0) {
    pinMode(PWREN_PIN, OUTPUT);
    digitalWrite(PWREN_PIN, HIGH);
    delay(10);
  }

  // Initialize I2C bus.
  DEV_I2C.begin(39,40);
  DEV_I2C.setClock(1000000); //Sensor has max I2C freq of 1MHz

  
  // Configure VL53L8CX component.
  sensor_VL53L8CX_top.begin();
  sensor_VL53L8CX_top.init_sensor();
  sensor_VL53L8CX_top.vl53l8cx_set_ranging_frequency_hz(30);
  sensor_VL53L8CX_top.vl53l8cx_set_resolution(res);

  Serial.println("starting to measure");
  // Start Measurements.
  sensor_VL53L8CX_top.vl53l8cx_start_ranging(); 

  return true;
}

VL53L8CX_ResultsData Results;
uint8_t NewDataReady = 0;
uint8_t status;
int lastReading = 0;
bool ReadVL53L8CX(float* input,
                       int length, bool reset_buffer) {
                        // Clear the buffer if required, e.g. after a successful prediction

  int8_t i, j, k, l;
  uint8_t zones_per_line;
  uint8_t number_of_zones = res;

  zones_per_line = (number_of_zones == 16) ? 4 : 8;
  if (reset_buffer) {
    memset(save_data, 0, RING_BUFFER_SIZE * sizeof(float)*64);
    begin_index = 0;
    pending_initial_data = true;
  }
  status = sensor_VL53L8CX_top.vl53l8cx_check_data_ready(&NewDataReady);
  if ((!status) && (NewDataReady != 0)) {

    status = sensor_VL53L8CX_top.vl53l8cx_get_ranging_data(&Results);
#if BLUETOOTH
    int index = 0;
    int characteristic = 0;
#endif
    for (j = 0; j < number_of_zones; j += zones_per_line)
    {
      for (l = 0; l < VL53L8CX_NB_TARGET_PER_ZONE; l++)
      {
        for (k = (zones_per_line - 1); k >= 0; k--)
        {
          if((float)(&Results)->target_status[(VL53L8CX_NB_TARGET_PER_ZONE * (j+k)) + l] == 255.0 || (float)(&Results)->distance_mm[(VL53L8CX_NB_TARGET_PER_ZONE * (j+k)) + l] > 2000.0){
            save_data[begin_index++] = 0.0;
          } else {
            save_data[begin_index++] = (float)(&Results)->distance_mm[(VL53L8CX_NB_TARGET_PER_ZONE * (j+k)) + l];
          }
#if BLUETOOTH
          index = index+1;
          if(index>=4) {
            bool isConnected = SenseBoxBLE::write(distanceCharacteristics[characteristic++], save_data[begin_index], save_data[begin_index-1], save_data[begin_index-2], save_data[begin_index-3]);
            index = 0;
          }
#endif
        }
      }
    }

    NewDataReady = 0;
    // If we reached the end of the circle buffer, reset
    if (begin_index >= (RING_BUFFER_SIZE)) {
      begin_index = 0;
      // Check if we are ready for prediction or still pending more initial data
      if (pending_initial_data) {
        pending_initial_data = false;
      }
    }

    // Return if we don't have enough data
    if (pending_initial_data) {
      return false;
    }

    // Copy the requested number of bytes to the provided input tensor

    for (int i = 0; i < length; ++i) {
      int ring_array_index = begin_index + i - length;
      if (ring_array_index < 0) {
        ring_array_index += (RING_BUFFER_SIZE);
      }
      input[i] = (save_data[ring_array_index]-means[i])/std_deviations[i];
      // Serial.print(input[i]);
      // Serial.print(",");
    }
    // Serial.print("\n");
    return true;
  }
  
  return false;
}
