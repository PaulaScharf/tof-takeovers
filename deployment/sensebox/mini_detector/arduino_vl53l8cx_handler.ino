
#include <Arduino.h>
#include <Wire.h>
#include <vl53l8cx_class.h>

#define DEV_I2C Wire
#define LPN_PIN 4
#define I2C_RST_PIN -1
#define PWREN_PIN 2
VL53L8CX sensor_VL53L8CX_top(&DEV_I2C, LPN_PIN, I2C_RST_PIN);

void measure(void);

VL53L8CX_DetectionThresholds thresholds[VL53L8CX_NB_THRESHOLDS];
const int res = VL53L8CX_RESOLUTION_8X8;

bool EnableAmbient = false;
bool EnableSignal = false;
char report[256];
volatile int interruptCount = 0;

// A buffer holding the last 200 sets of 3-channel values
const int RING_BUFFER_SIZE = 1280;
int save_data[RING_BUFFER_SIZE] = {0.0};
// Most recent position in the save_data buffer
int begin_index = 0;
// True if there is not yet enough data to run inference
bool pending_initial_data = true;
// How often we should save a measurement during downsampling
int sample_every_n;
// The number of measurements since we last saved one
int sample_skip_counter = 1;

// Mean array
double means[] = {325.3030651340996, 371.9896551724138, 399.80536398467433, 434.6846743295019, 454.04597701149424, 385.8134099616858, 378.05057471264365, 267.13984674329504, 217.75095785440612, 206.53333333333333, 191.43333333333334, 205.85977011494253, 246.27969348659005, 188.33639846743296, 173.27471264367816, 185.50842911877393, 203.27011494252875, 131.46973180076628, 125.46743295019157, 132.92337164750958, 165.44674329501916, 131.8735632183908, 124.83371647509578, 184.36436781609194, 198.51877394636014, 144.7103448275862, 126.57088122605364, 132.79540229885058, 128.64980842911876, 141.91302681992337, 127.16513409961686, 202.28735632183907, 190.45210727969348, 137.60498084291189, 117.04942528735633, 129.9950191570881, 132.3455938697318, 134.76015325670497, 150.18850574712644, 215.32681992337166, 214.6199233716475, 136.14291187739462, 116.15095785440613, 123.29233716475096, 127.54137931034482, 139.24942528735633, 158.67777777777778, 240.48888888888888, 195.855938697318, 168.70268199233718, 132.0743295019157, 132.73371647509578, 151.83141762452107, 190.75632183908047, 189.90038314176246, 216.72107279693486, 176.42337164750958, 183.544061302682, 170.59003831417624, 139.59195402298852, 155.37662835249043, 193.32030651340997, 204.83639846743296, 153.2888888888889, 347.1, 399.70842911877395, 391.1950191570881, 440.15019157088125, 472.2808429118774, 400.6478927203065, 390.45708812260534, 269.76590038314174, 245.57241379310344, 216.22605363984675, 205.45210727969348, 210.41417624521074, 252.0927203065134, 208.8233716475096, 176.84214559386973, 200.6183908045977, 236.0823754789272, 143.92605363984674, 138.14367816091954, 133.7183908045977, 166.39310344827587, 131.80727969348658, 135.52835249042147, 189.10689655172413, 234.91379310344828, 143.8206896551724, 133.69540229885058, 129.61417624521073, 129.5662835249042, 143.40842911877394, 123.9455938697318, 209.34712643678162, 210.61379310344827, 146.7919540229885, 125.18045977011494, 129.32107279693486, 132.6735632183908, 134.28199233716475, 159.95210727969348, 222.7153256704981, 221.28429118773946, 144.77318007662836, 121.15670498084292, 125.43869731800767, 129.360153256705, 142.355938697318, 162.90383141762453, 248.38927203065134, 206.32605363984675, 173.93716475095786, 136.86704980842913, 129.70421455938697, 152.94942528735632, 190.53026819923372, 195.5831417624521, 222.76283524904215, 191.672030651341, 196.29157088122605, 180.4383141762452, 150.0816091954023, 157.10574712643677, 195.79885057471265, 211.59195402298852, 152.53333333333333, 366.18812260536396, 421.016091954023, 418.8425287356322, 468.0206896551724, 508.048275862069, 427.22375478927205, 405.444061302682, 299.6229885057471, 271.46858237547895, 250.86934865900383, 245.99616858237547, 236.3750957854406, 281.8689655172414, 223.4455938697318, 195.1007662835249, 219.86628352490422, 266.23218390804595, 184.83409961685823, 168.5168582375479, 164.9095785440613, 195.80919540229885, 157.81149425287356, 148.66015325670497, 205.16973180076627, 268.48352490421456, 186.61455938697318, 166.5088122605364, 152.76053639846742, 147.85019157088124, 161.75632183908047, 140.8383141762452, 230.49846743295018, 243.87586206896552, 172.88659003831418, 141.96436781609196, 147.98429118773947, 149.2375478927203, 147.13409961685824, 173.14214559386974, 226.41532567049808, 238.62681992337164, 161.89080459770116, 145.75172413793103, 143.2455938697318, 137.95632183908046, 153.47624521072797, 170.9823754789272, 257.09080459770115, 225.1536398467433, 185.41724137931035, 152.9551724137931, 146.32758620689654, 169.03141762452108, 200.2616858237548, 193.50268199233716, 234.4256704980843, 205.12758620689655, 204.83984674329503, 192.72950191570882, 159.00383141762453, 169.7624521072797, 200.2007662835249, 220.6888888888889, 163.48659003831418, 390.91570881226056, 438.023754789272, 448.0386973180077, 507.53180076628354, 523.3766283524905, 446.38467432950193, 432.127969348659, 316.59501915708813, 297.69846743295017, 278.05670498084294, 275.94942528735635, 276.6904214559387, 312.63869731800764, 261.05172413793105, 228.14444444444445, 231.8735632183908, 297.4168582375479, 210.2816091954023, 209.47854406130267, 201.36206896551724, 239.85134099616857, 194.18697318007662, 181.40268199233716, 222.97088122605365, 294.3141762452107, 228.50996168582375, 209.9191570881226, 200.69425287356322, 195.59425287356322, 192.65823754789272, 173.71685823754788, 246.4095785440613, 268.86590038314176, 208.43295019157088, 183.04022988505747, 193.51877394636014, 190.79731800766282, 180.2103448275862, 190.49386973180077, 250.40306513409962, 259.3639846743295, 183.9344827586207, 163.16206896551725, 167.11226053639848, 161.0375478927203, 173.4095785440613, 186.39310344827587, 270.1429118773946, 231.37011494252874, 203.46168582375478, 171.2153256704981, 159.79003831417626, 184.26934865900384, 211.81149425287356, 209.62030651340996, 233.1206896551724, 216.52145593869733, 229.29233716475096, 211.36896551724138, 178.22605363984675, 180.2521072796935, 219.65019157088122, 229.46934865900383, 177.9655172413793, 413.11494252873564, 464.62605363984676, 487.56283524904217, 539.1540229885057, 553.0095785440614, 475.77816091954026, 455.8567049808429, 331.9701149425287, 331.86934865900383, 326.47241379310344, 320.332183908046, 327.9463601532567, 368.8888888888889, 297.2701149425287, 277.9318007662835, 256.40498084291187, 329.7318007662835, 249.61570881226055, 260.2590038314176, 258.95478927203067, 294.9214559386973, 238.70957854406132, 219.7735632183908, 249.04137931034484, 327.63639846743297, 274.2260536398467, 246.55517241379312, 266.5091954022989, 261.36590038314176, 237.05938697318007, 221.58773946360154, 267.7022988505747, 311.4670498084291, 245.38352490421457, 234.8793103448276, 253.86398467432952, 250.216091954023, 225.96053639846744, 227.94137931034481, 271.2605363984674, 282.4942528735632, 214.5808429118774, 190.66015325670497, 206.81877394636015, 202.49846743295018, 202.5816091954023, 217.7, 285.235632183908, 246.0295019157088, 226.90038314176246, 190.5808429118774, 192.81992337164752, 216.02911877394635, 236.26206896551724, 230.64214559386974, 244.1816091954023, 230.94022988505748, 240.0199233716475, 224.70727969348658, 201.1639846743295, 208.30191570881226, 234.91034482758621, 245.35210727969348, 178.96781609195403, 445.4808429118774, 492.88007662835247, 513.5045977011495, 572.3613026819924, 581.748275862069, 501.56283524904217, 468.74597701149423, 357.24252873563216, 363.0486590038314, 377.7452107279693, 367.99885057471266, 381.94521072796937, 409.3, 339.6413793103448, 305.2639846743295, 290.7501915708812, 364.60613026819925, 297.99272030651343, 306.0501915708812, 315.0980842911877, 341.85019157088124, 285.10689655172416, 267.4528735632184, 286.9072796934866, 363.8773946360153, 316.30268199233717, 295.1812260536398, 318.59463601532565, 303.892337164751, 288.3137931034483, 262.6084291187739, 303.84061302681994, 341.8375478927203, 284.6122605363985, 284.5049808429119, 302.1697318007663, 302.9114942528736, 272.383908045977, 269.3007662835249, 303.0444444444444, 312.63026819923374, 253.3793103448276, 233.39961685823755, 253.62413793103448, 240.67586206896553, 236.80421455938696, 240.0758620689655, 305.060153256705, 276.3337164750958, 257.4747126436782, 225.10114942528736, 231.19463601532567, 247.2176245210728, 260.16053639846746, 256.26513409961683, 263.12950191570883, 250.61111111111111, 261.98122605363983, 246.16130268199234, 230.21494252873563, 236.33180076628352, 258.23754789272033, 269.92911877394636, 211.57662835249042, 493.4164750957854, 535.9551724137931, 547.3195402298851, 610.6306513409962, 625.9471264367816, 529.3532567049808, 498.1659003831418, 391.7946360153257, 405.16513409961686, 425.3088122605364, 413.060153256705, 424.7272030651341, 469.4367816091954, 390.151724137931, 358.48927203065136, 331.0789272030651, 403.155938697318, 342.6, 357.7053639846743, 362.4409961685824, 401.31954022988504, 326.2528735632184, 311.77624521072795, 324.0352490421456, 400.27777777777777, 363.6896551724138, 348.1486590038314, 364.4528735632184, 364.11072796934866, 333.4613026819923, 306.07969348659003, 348.4659003831418, 385.0942528735632, 341.3436781609195, 327.72452107279696, 360.38007662835247, 353.808429118774, 330.65977011494255, 316.96819923371646, 353.18429118773946, 341.788122605364, 284.1574712643678, 271.0992337164751, 300.33065134099616, 289.5375478927203, 284.6130268199234, 280.43563218390807, 336.31111111111113, 300.5295019157088, 291.6413793103448, 259.6429118773946, 272.10574712643677, 284.2432950191571, 300.53563218390804, 291.4363984674329, 286.044061302682, 281.80191570881226, 285.1409961685824, 283.4448275862069, 270.0080459770115, 265.476245210728, 289.6034482758621, 303.5781609195402, 239.45478927203064, 516.2521072796935, 555.7950191570882, 565.4329501915709, 649.0145593869731, 666.3348659003832, 561.1187739463602, 520.2977011494253, 412.3352490421456, 426.79808429118776, 464.1727969348659, 451.132183908046, 483.1310344827586, 529.5360153256705, 429.80689655172415, 387.2785440613027, 359.38850574712643, 443.09616858237547, 384.52222222222224, 398.80996168582374, 413.21724137931034, 444.0674329501916, 384.4360153256705, 362.90536398467435, 365.08084291187737, 437.73333333333335, 410.85095785440615, 397.9072796934866, 410.2413793103448, 404.5137931034483, 397.1310344827586, 364.2145593869732, 383.4793103448276, 415.71954022988507, 378.13409961685824, 377.58620689655174, 404.58697318007665, 393.9647509578544, 371.5919540229885, 369.6176245210728, 382.83180076628355, 359.823754789272, 321.75555555555553, 306.63984674329504, 343.33065134099616, 335.31609195402297, 330.22030651341, 316.5777777777778, 364.0827586206897, 323.451724137931, 312.9367816091954, 288.5731800766284, 309.45325670498084, 323.0329501915709, 337.50344827586207, 322.78850574712646, 309.2934865900383, 302.8229885057471, 317.4057471264368, 312.96666666666664, 299.5632183908046, 312.29731800766285, 332.3344827586207, 340.2103448275862, 257.41915708812263, 514.2747126436782, 571.5007662835249, 586.1088122605364, 651.8195402298851, 687.0773946360154, 577.0007662835249, 530.5137931034483, 438.46206896551723, 433.855938697318, 485.73295019157086, 473.2153256704981, 520.9, 556.0111111111111, 467.90383141762453, 417.5425287356322, 392.3222222222222, 451.8865900383142, 412.41570881226056, 429.9946360153257, 451.04750957854407, 483.7888888888889, 421.3233716475096, 392.51187739463603, 400.7662835249042, 456.43908045977014, 433.91072796934867, 423.15785440613024, 456.4360153256705, 452.6432950191571, 430.2823754789272, 402.2639846743295, 405.7241379310345, 444.2547892720307, 411.8344827586207, 410.88275862068963, 441.2835249042146, 451.9846743295019, 424.6800766283525, 407.3176245210728, 427.29157088122605, 383.4478927203065, 339.855938697318, 335.3149425287356, 379.8153256704981, 381.1287356321839, 364.50613026819923, 357.6176245210728, 381.29616858237546, 343.47394636015326, 347.4421455938697, 319.06513409961684, 344.9961685823755, 364.47892720306515, 380.30268199233717, 356.46934865900386, 327.99885057471266, 324.72835249042146, 334.50268199233716, 333.4735632183908, 332.38505747126436, 339.9383141762452, 352.15785440613024, 363.67318007662834, 266.2241379310345, 516.1708812260537, 575.1513409961685, 586.2452107279694, 675.2099616858237, 685.9141762452107, 582.5643678160919, 556.3977011494253, 447.2003831417625, 444.3770114942529, 486.22681992337164, 484.72835249042146, 534.0318007662835, 579.9620689655172, 495.94942528735635, 436.2463601532567, 408.15900383141764, 456.22681992337164, 417.73333333333335, 439.7390804597701, 472.0977011494253, 503.07586206896553, 445.37471264367815, 417.77088122605363, 411.20766283524904, 451.30153256704983, 452.69808429118774, 435.01647509578544, 483.7310344827586, 475.1375478927203, 458.21800766283525, 432.2992337164751, 432.18812260536396, 445.8681992337165, 423.07241379310346, 433.9816091954023, 466.5471264367816, 464.3674329501916, 447.49808429118775, 436.16053639846746, 454.6007662835249, 396.16513409961686, 356.5877394636015, 349.76781609195405, 393.42337164750955, 389.7406130268199, 382.4383141762452, 370.9862068965517, 392.1632183908046, 355.9229885057471, 357.3333333333333, 338.5057471264368, 363.84061302681994, 379.0632183908046, 392.45325670498084, 365.1318007662835, 328.79540229885055, 328.0463601532567, 349.7590038314176, 354.7337164750958, 353.22030651341, 358.7808429118774, 372.2931034482759, 371.7015325670498, 280.75172413793103, 524.1344827586207, 567.3574712643679, 574.6777777777778, 660.7969348659004, 677.7735632183908, 574.8191570881226, 548.3019157088123, 459.7145593869732, 427.5329501915709, 482.18812260536396, 473.1927203065134, 530.5563218390805, 579.6141762452107, 485.05095785440614, 448.45249042145593, 418.023754789272, 451.2800766283525, 418.0425287356322, 436.1084291187739, 466.9176245210728, 497.1862068965517, 456.7463601532567, 418.74827586206897, 427.43486590038316, 437.2494252873563, 448.9919540229885, 434.61494252873564, 467.4402298850575, 477.38352490421454, 464.4383141762452, 443.26781609195405, 451.32107279693486, 442.3689655172414, 415.45900383141765, 428.11647509578546, 474.03678160919543, 483.9344827586207, 458.855938697318, 437.52222222222224, 462.73256704980844, 396.1176245210728, 354.96436781609196, 356.41800766283524, 409.1191570881226, 407.45402298850576, 385.2, 381.82605363984675, 402.32145593869734, 358.34214559386976, 369.9402298850575, 351.7183908045977, 377.80689655172415, 383.8770114942529, 402.8034482758621, 379.523754789272, 354.05325670498087, 335.1632183908046, 358.5348659003831, 365.19233716475094, 360.62950191570883, 370.64904214559385, 398.8735632183908, 391.7639846743295, 300.12835249042143, 506.08084291187737, 555.3942528735632, 552.8693486590038, 653.9574712643678, 653.2888888888889, 552.4892720306514, 526.892337164751, 445.7452107279693, 406.9854406130268, 461.2904214559387, 454.00766283524905, 497.92988505747127, 547.2804597701149, 460.0352490421456, 423.3984674329502, 412.71379310344827, 418.74367816091956, 393.4072796934866, 409.76513409961683, 436.74827586206897, 474.9057471264368, 435.07011494252873, 402.7758620689655, 422.21264367816093, 421.66896551724136, 421.7697318007663, 412.432183908046, 444.7049808429119, 446.1333333333333, 445.69003831417626, 421.1409961685824, 453.8367816091954, 425.60421455938695, 398.65555555555557, 397.2509578544061, 443.9563218390805, 441.66053639846746, 431.84904214559384, 425.1823754789272, 450.4268199233716, 382.64827586206894, 349.3724137931035, 341.8245210727969, 380.0536398467433, 384.3429118773946, 377.4061302681992, 380.8072796934866, 403.6383141762452, 349.89961685823755, 353.69731800766283, 328.36436781609194, 366.9754789272031, 375.87969348659004, 404.9210727969349, 375.4409961685824, 355.7996168582375, 324.22758620689655, 349.81111111111113, 357.91302681992335, 363.57969348659003, 365.93295019157085, 383.65555555555557, 392.72911877394637, 300.16053639846746, 475.4463601532567, 528.7513409961686, 538.3249042145594, 627.6977011494253, 637.3509578544061, 540.0777777777778, 508.0693486590038, 439.80038314176244, 380.82911877394633, 416.3582375478927, 412.4111111111111, 466.39501915708814, 504.42605363984677, 432.4992337164751, 394.21417624521075, 385.16896551724136, 385.7252873563218, 354.2249042145594, 364.0486590038314, 404.24176245210725, 433.75823754789275, 404.611877394636, 376.31609195402297, 398.444061302682, 397.5157088122605, 380.0176245210728, 373.7406130268199, 401.0689655172414, 401.495785440613, 420.7850574712644, 395.20766283524904, 434.95325670498084, 398.21724137931034, 372.22260536398466, 352.7344827586207, 394.2053639846743, 396.1513409961686, 400.155938697318, 398.9662835249042, 442.68927203065135, 368.86360153256703, 324.3927203065134, 319.30996168582374, 349.1318007662835, 349.00191570881225, 357.29080459770114, 366.4727969348659, 407.2463601532567, 340.3080459770115, 329.28199233716475, 309.6624521072797, 340.74367816091956, 351.36436781609194, 388.7609195402299, 362.34214559386976, 352.6455938697318, 311.27318007662836, 339.516091954023, 341.7498084291188, 346.5873563218391, 353.8816091954023, 389.1712643678161, 394.6463601532567, 301.3624521072797, 445.5590038314176, 495.01685823754786, 512.0578544061302, 592.1402298850575, 604.8973180076629, 510.3103448275862, 480.4908045977011, 414.09157088122606, 343.1222222222222, 372.3233716475096, 371.8582375478927, 423.9911877394636, 452.8080459770115, 389.11072796934866, 351.8383141762452, 357.28850574712646, 342.84214559386976, 309.33103448275864, 322.72183908045974, 348.4314176245211, 387.6758620689655, 359.28697318007664, 334.99731800766284, 378.7850574712644, 358.9808429118774, 327.5977011494253, 315.30766283524906, 352.7471264367816, 353.4344827586207, 372.4992337164751, 350.48314176245214, 411.86551724137934, 350.37931034482756, 314.6383141762452, 305.5425287356322, 343.77624521072795, 350.49272030651343, 352.12911877394635, 356.955938697318, 418.58620689655174, 342.739846743295, 285.6429118773946, 278.69233716475094, 306.80191570881226, 310.49386973180077, 326.18888888888887, 337.55249042145596, 384.527969348659, 311.8199233716475, 306.22681992337164, 283.37164750957857, 306.5436781609195, 321.27547892720304, 367.583908045977, 344.47969348659007, 341.94329501915706, 287.6383141762452, 317.40536398467435, 318.85057471264366, 325.91302681992335, 335.31226053639847, 367.1318007662835, 374.71379310344827, 278.2390804597701, 400.42375478927204, 462.5992337164751, 478.9114942528736, 554.0429118773947, 571.2126436781609, 476.2701149425287, 467.3091954022988, 378.1390804597701, 304.2681992337165, 321.0038314176245, 320.8383141762452, 366.18429118773946, 412.16513409961686, 348.6950191570881, 312.90383141762453, 336.7528735632184, 297.34674329501917, 261.46858237547895, 272.5375478927203, 299.90996168582376, 336.68352490421455, 305.48314176245214, 293.4168582375479, 339.04176245210726, 313.06130268199234, 280.57164750957855, 268.38505747126436, 303.91302681992335, 297.2337164750958, 321.6337164750958, 305.00613026819923, 371.7551724137931, 306.2, 265.96743295019155, 246.14214559386974, 290.38122605363986, 297.11455938697316, 301.451724137931, 319.6862068965517, 373.1655172413793, 314.2191570881226, 241.98390804597702, 230.05938697318007, 260.55057471264365, 261.0256704980843, 283.3873563218391, 299.51149425287355, 357.6275862068965, 279.5977011494253, 271.45402298850576, 243.7448275862069, 266.4609195402299, 282.71954022988507, 327.96436781609196, 315.5099616858238, 318.82911877394633, 257.97164750957853, 286.09578544061304, 285.57547892720305, 290.51800766283526, 297.8126436781609, 332.7402298850575, 348.49386973180077, 264.43946360153257, 372.2, 429.08429118773944, 438.9065134099617, 515.5712643678161, 535.4643678160919, 450.388122605364, 442.0773946360153, 370.455938697318, 272.672030651341, 280.09578544061304, 273.63486590038315, 307.160153256705, 349.36053639846745, 294.3333333333333, 270.5436781609195, 295.823754789272, 266.2111111111111, 206.93218390804597, 214.96781609195403, 231.7191570881226, 282.3168582375479, 254.20919540229886, 247.54214559386972, 292.9498084291188, 267.4712643678161, 226.45938697318007, 212.37586206896552, 244.30689655172415, 243.25402298850574, 262.08199233716476, 253.4854406130268, 326.6222222222222, 268.64980842911876, 218.40038314176246, 199.78735632183907, 235.13946360153255, 243.49310344827586, 257.460153256705, 268.4697318007663, 336.8448275862069, 277.764367816092, 197.0984674329502, 186.4367816091954, 210.03831417624522, 209.4390804597701, 237.97088122605365, 254.26436781609195, 334.22452107279696, 248.49693486590039, 235.8406130268199, 197.2153256704981, 221.03524904214558, 235.72911877394637, 286.22835249042146, 274.07624521072796, 296.0183908045977, 240.1168582375479, 246.79655172413794, 247.81647509578545, 240.03141762452108, 256.0731800766284, 300.89463601532566, 308.6609195402299, 251.75325670498086, 360.38505747126436, 401.05134099616856, 417.1065134099617, 479.6662835249042, 510.7946360153257, 418.83141762452107, 418.99310344827586, 339.9697318007663, 244.32030651340997, 251.54904214559386, 241.6183908045977, 265.77662835249043, 302.99731800766284, 255.3455938697318, 237.74329501915707, 260.9256704980843, 231.86398467432952, 168.24865900383142, 178.82452107279693, 194.2697318007663, 231.8111111111111, 211.59731800766284, 202.42337164750958, 254.4727969348659, 233.22260536398468, 179.11609195402298, 163.68697318007662, 192.9808429118774, 197.4432950191571, 215.97624521072797, 208.4287356321839, 287.451724137931, 231.40191570881225, 179.71226053639847, 153.1494252873563, 183.2272030651341, 195.99386973180077, 199.86628352490422, 218.55632183908045, 300.6773946360153, 253.7624521072797, 163.98352490421456, 154.9241379310345, 165.58850574712645, 168.27547892720307, 195.0816091954023, 211.30689655172415, 305.99157088122604, 213.76896551724138, 203.72222222222223, 159.16015325670497, 176.24597701149426, 193.70268199233718, 245.83065134099616, 249.044061302682, 268.332183908046, 221.36398467432952, 209.89770114942527, 211.23908045977012, 197.75402298850574, 210.06858237547894, 258.5191570881226, 278.3103448275862, 226.955938697318, 343.823754789272, 391.45249042145593, 400.8609195402299, 469.9367816091954, 489.00306513409964, 403.75249042145595, 398.7164750957854, 322.46934865900386, 242.1793103448276, 236.4199233716475, 213.9015325670498, 248.9072796934866, 275.588122605364, 220.32490421455938, 213.13409961685824, 237.8505747126437, 221.23256704980844, 146.01532567049807, 154.47854406130267, 155.05057471264368, 196.3095785440613, 171.88773946360152, 166.71149425287356, 228.12375478927203, 225.74597701149426, 155.13601532567048, 143.59003831417624, 147.62988505747126, 151.78620689655173, 179.0616858237548, 169.5808429118774, 254.81417624521072, 221.16360153256704, 159.3463601532567, 131.7750957854406, 146.66053639846743, 147.73793103448276, 157.62222222222223, 181.72528735632184, 257.0478927203065, 230.69272030651342, 142.1536398467433, 130.12183908045978, 135.78505747126437, 143.01839080459771, 167.05977011494252, 179.57547892720308, 276.80766283524906, 205.65478927203065, 183.62758620689655, 136.65555555555557, 151.5455938697318, 172.02835249042147, 218.16283524904213, 221.911877394636, 246.11724137931034, 198.27854406130268, 191.44904214559386, 182.42988505747127, 169.60689655172413, 181.5337164750958, 225.4383141762452, 248.57892720306512, 208.3478927203065, 340.79003831417623, 378.81609195402297, 391.80689655172415, 447.560153256705, 473.66513409961686, 402.46781609195403, 391.2946360153257, 302.8379310344828, 233.05210727969347, 223.93563218390804, 204.76934865900384, 226.64980842911876, 251.4241379310345, 204.32720306513409, 190.56206896551726, 219.78697318007661, 219.6103448275862, 137.74291187739465, 142.4111111111111, 144.64061302681992, 175.60613026819922, 149.1831417624521, 147.09501915708813, 197.33218390804598, 214.49233716475095, 147.76513409961686, 134.92107279693488, 141.4095785440613, 136.71877394636016, 154.27471264367816, 142.67892720306514, 227.86168582375478, 205.98620689655172, 154.46973180076628, 126.30842911877394, 134.0287356321839, 140.04252873563217, 146.3168582375479, 160.88582375478927, 237.13869731800767, 223.87318007662836, 139.73563218390805, 125.70842911877395, 130.07164750957855, 128.91724137931035, 148.2697318007663, 160.58045977011494, 266.63448275862066, 197.94827586206895, 175.39003831417625, 131.80613026819924, 140.20727969348658, 156.52260536398467, 199.92298850574713, 204.77624521072798, 228.11570881226055, 184.75938697318009, 182.37816091954022, 171.13946360153255, 147.5639846743295, 169.27777777777777, 205.65478927203065, 231.14674329501915, 184.4873563218391, 337.94750957854404, 376.15325670498083, 386.63984674329504, 442.82911877394633, 452.3586206896552, 397.79540229885055, 376.27318007662836, 296.8877394636015, 231.4463601532567, 225.46666666666667, 200.35900383141762, 225.20421455938697, 258.3448275862069, 189.8704980842912, 182.6823754789272, 192.2846743295019, 223.51609195402298, 136.0241379310345, 145.48275862068965, 145.35785440613026, 172.83486590038314, 143.0417624521073, 128.6888888888889, 179.8367816091954, 208.93218390804597, 151.4544061302682, 137.26015325670497, 141.58697318007663, 143.28697318007661, 151.1080459770115, 146.7670498084291, 199.06781609195403, 208.37701149425288, 155.56819923371648, 129.5471264367816, 139.6272030651341, 145.7800766283525, 147.5727969348659, 155.82911877394636, 217.04904214559386, 213.12758620689655, 142.0, 124.45402298850574, 131.6072796934866, 131.77586206896552, 148.18735632183908, 155.06743295019157, 238.6992337164751, 198.99233716475095, 172.09157088122606, 132.47931034482758, 132.54904214559386, 156.70727969348658, 194.2793103448276, 200.82605363984675, 221.83256704980843, 178.18850574712644, 184.29080459770114, 163.43984674329502, 141.13716475095785, 160.29961685823756, 194.56704980842912, 218.55019157088122, 158.9735632183908};

// Standard deviation array
double std_deviations[] = {567.1359217554415, 606.7841602533506, 629.4600742742365, 663.9374559379127, 689.2086073167719, 622.2280587840606, 610.2269451976565, 531.1209868430268, 449.5244725128671, 456.45654852313726, 444.9212745809225, 470.0163153098182, 546.0744183996878, 479.5961194525301, 463.4746902665104, 469.11069216106256, 435.32172740200167, 314.0515357254267, 291.6879662053998, 303.17531609452493, 392.94238563444793, 343.2777581824701, 367.1934981315653, 466.71236906185413, 433.332228813834, 345.5703681137488, 291.61697007613975, 299.35535895773694, 297.19229421595475, 347.3304836167695, 344.41422524989287, 485.1483371065241, 434.0873707071386, 328.1263819078357, 267.42364586812715, 299.71980077903197, 310.61914334500824, 337.7623526110567, 399.509275258169, 493.88168896067947, 480.1599856960133, 347.7567111515002, 281.6638784617527, 295.85368001698936, 318.21154680124, 367.1215541045982, 433.75809509648167, 524.4730390120064, 467.66156338428186, 414.1342385515832, 330.1685147238784, 332.45975871080987, 380.48533224695865, 473.585487725471, 493.2694002141149, 490.60708070739094, 445.8410052726215, 451.1387173713593, 423.607867964168, 356.82047088278074, 402.2677358814161, 477.9202318153628, 520.363988855276, 410.4673955708721, 577.5839720675012, 617.1496645652586, 619.8268111018043, 664.1281234940078, 693.2928025128688, 626.8499302259632, 614.0086298936344, 529.1720591507786, 470.9205726578647, 463.765264902842, 453.11438108087304, 476.72009718848847, 547.603121925367, 500.3853088452659, 465.07576483408536, 483.6011695147471, 463.81725877345224, 329.90052415026236, 317.28594565566414, 305.8969726247908, 396.44998847572094, 342.5199169540721, 377.4246693009117, 472.2090229655318, 466.16980594057117, 336.9320088323007, 300.88488834187234, 291.67898461705, 297.1170074307067, 349.31392561171674, 339.2151162968186, 489.5544027171158, 457.85025271301004, 342.8245186485401, 289.2980247560601, 295.4932825869676, 308.4506393044169, 335.78914683423403, 415.9302490031102, 503.68967118743785, 481.70163300514486, 358.9102000424129, 291.47550445350043, 298.0981405752055, 323.86162639042675, 373.576909628072, 438.40885012779756, 529.1449983796483, 474.51683574505455, 420.1005470300531, 334.2000610288387, 324.9288195871973, 384.0918748469232, 474.26283355406696, 499.2019817332204, 497.47251842501805, 458.77542284290763, 464.7827899205656, 432.0991826723623, 373.60738382422954, 404.52656535047265, 481.5725531077585, 527.6102925974839, 408.53658821217715, 582.3996135134478, 620.3322893146352, 623.2705538117278, 666.6753921505887, 698.6772641989444, 633.6217744040433, 617.0245765744795, 548.7058389602543, 485.3034575889592, 493.48984720091283, 490.4285505593154, 491.28968979936036, 558.3327827021498, 507.318929355212, 478.6140537547138, 499.533527358428, 485.0466246485692, 384.4969162520437, 349.04194642928064, 344.5250385222936, 420.3921855211456, 371.4563536986966, 391.64390912409135, 483.3459442702057, 480.7387999630089, 384.74084537802906, 343.65063359220085, 326.49425976732726, 317.30022068674333, 370.19926860457196, 356.6927392815304, 503.7845425609262, 478.6427073452127, 368.30083407394005, 307.4215095826937, 320.1487419850538, 328.28320448196104, 352.3844856055012, 425.40736945450413, 502.1211176365898, 490.1780318233614, 377.8297777437974, 326.1395061006196, 323.35146860761427, 326.94803447842656, 383.8422254434902, 446.5983955327665, 532.390236372885, 488.6768096477648, 427.96513295875553, 352.85115318596274, 345.5485853989061, 403.83288405805854, 482.0647244617035, 492.41157227081584, 506.7821246549261, 466.9940561428139, 466.52438432611183, 439.53505434212786, 379.3938187650413, 413.9123783857646, 481.38986231498757, 533.797559951938, 421.47377171258097, 582.9570521880338, 617.4964539979786, 627.7053122595953, 671.0711926021229, 689.5435557230643, 632.6646239163069, 621.9671756064719, 548.7608566151279, 500.42575042005484, 498.73478221539926, 501.9487874092954, 512.9562855686829, 568.8342977961692, 533.2816239362293, 499.670498533935, 501.6658877589181, 500.27338520621396, 397.8392145322438, 388.88868547811904, 378.48684963000477, 457.948171003868, 412.42037975678545, 418.8455982402354, 491.13344387090507, 490.80898125702527, 417.30184057343376, 385.4926031771172, 373.6088843599917, 370.4527318795326, 404.0302505403315, 388.9084349671485, 511.8680868892731, 489.6533894372709, 398.2930411816763, 362.8677818671541, 367.76507138638124, 373.9738039575055, 385.49428464572225, 433.60093611695567, 516.8172935701103, 501.78144798123554, 400.6510600918233, 342.4440432768484, 351.01386820670496, 357.4427287514493, 401.55239904685186, 458.1878911036062, 539.274577200251, 487.57638107556585, 443.8486473023214, 376.1005729737426, 354.5109885089061, 409.9454330793806, 488.57862705035603, 501.08912519472193, 502.2432814747227, 474.26481088346065, 491.9362299990979, 459.1776673009827, 400.05686407512326, 423.5678778777835, 497.9282456211132, 539.2783264959861, 435.6660365034937, 582.551996106378, 618.1302337166641, 632.1388003516072, 666.9731577321207, 688.3784964061426, 634.3300084338458, 624.364409511789, 547.8204993335181, 513.3872424476526, 525.774503517759, 522.4737390957137, 538.4508261131409, 590.5631735757174, 551.8466805541952, 534.6028173890957, 511.9864427889788, 511.78390893860796, 428.01795069060654, 426.28754030188605, 430.43056260023855, 491.70117895566, 450.34813007354865, 449.99938832477034, 503.40530106299775, 507.8894719194776, 449.7000927516301, 410.6969585760174, 431.61627197927055, 426.2728433739777, 439.1365551826772, 433.2389112016385, 518.8036332192157, 512.2811076015518, 428.0698572862577, 410.5477683636054, 417.45447578656683, 420.85611620320634, 426.57148315773577, 459.551172854189, 523.5615575408285, 513.6845299667139, 430.1225573550516, 373.8241998545725, 389.50093585832644, 399.78082716379254, 431.2568574021917, 482.3936509958156, 544.2301892431219, 492.1359874710645, 463.4519438439403, 393.6975692476059, 393.103005504146, 440.37892330010857, 502.2448742350053, 515.7973338092638, 506.72232298564654, 479.77586508568885, 496.80554756713485, 466.7337867829838, 419.57065713347663, 451.0352145737649, 506.89513641213006, 546.5299834078261, 427.97385304194427, 586.1219302039092, 612.8059868934114, 627.7361723575764, 660.9695190343923, 681.1219850173967, 634.0458672371769, 618.5159907994458, 554.7710913387398, 521.9084008313672, 544.4779296953539, 543.2322376142207, 564.6703860579692, 595.2887377268008, 566.8455560538698, 537.5977035372177, 529.376341345007, 523.7754502277387, 458.5487722972972, 460.47109910719706, 470.59879801551557, 515.9071252159854, 480.82418831354573, 485.1799171376103, 524.86346393206, 514.4390654078801, 469.0901362139158, 441.6887182870967, 462.55871538860407, 448.7025257427772, 474.2415053169702, 457.1755591487508, 533.8403472558485, 518.2487357952493, 452.90407313970746, 444.92486448013045, 450.15491152623497, 458.91923201734716, 457.31344806310165, 485.648247466839, 533.6146445041487, 524.9396762310287, 456.5417450090658, 414.58428155594993, 428.5080918504865, 433.0382168278595, 457.93869277709075, 492.7378477264673, 551.2256401359352, 509.3149776785682, 483.616325727301, 424.7301569748604, 424.9585741022629, 461.8032705444439, 515.5905811864113, 529.3913133534595, 516.4919482959451, 487.48912328087516, 504.10204756594925, 474.4632478899741, 439.7718523873484, 465.79644916405846, 518.0017081290741, 556.4470651869432, 453.5138844201047, 589.4642460995583, 611.3276613116246, 624.3491009121021, 652.9750917746555, 672.9889909045436, 628.3910508255135, 617.2426192520443, 563.4429669298587, 532.1748343729948, 556.0546870405961, 550.6835138234225, 570.5109767778163, 608.246449493495, 579.0023464630095, 561.761331154014, 542.5271424398106, 531.8144353915053, 475.9034829221901, 483.6427905198241, 492.2477895991928, 537.5322524417621, 494.9205505741619, 501.6019079626046, 538.8212801454501, 519.9516716457107, 488.0229913483128, 473.13350983669045, 481.0295020876743, 478.85641190052365, 493.6733678216674, 482.1384832396141, 550.3459265548627, 529.3471931412414, 484.531642846785, 468.1252144977084, 479.83171976907266, 480.98064107997203, 494.5959835316272, 511.45395644517595, 554.4544142257166, 530.8723659233668, 465.28480392767966, 438.8647472717309, 454.2089640318159, 463.50348848654625, 486.2801327353784, 512.335377797956, 560.6599694058491, 513.2720400145244, 497.09411149438165, 440.48497706142973, 447.0458112989325, 478.20506851227395, 532.558191444286, 545.040837846452, 522.6643670534057, 502.4107463825006, 512.1129694999357, 494.1690639996016, 462.3796390268534, 479.35455128138443, 533.2437390869824, 569.5826376002184, 471.042471979011, 585.7403155706728, 601.5412603204468, 616.4428468522915, 645.3237286281615, 663.3893355113518, 621.133472980433, 611.2536435376155, 561.5700642247298, 529.6814211288238, 563.6167644014853, 556.4366347612511, 581.794218859352, 615.743530575995, 583.1994048803725, 562.19004521094, 543.2228799849529, 538.1941690027296, 493.98971990913395, 499.9255361183472, 511.5642009888751, 544.0924765506358, 520.9567244418778, 525.1177622439574, 550.5936823493051, 524.3347276946919, 502.80543338360883, 494.6438315986332, 495.19583259277795, 487.25935960864354, 518.2942074844717, 509.4557872622486, 554.906727650568, 533.5348766831804, 496.08753671731995, 486.07189017172584, 493.30951043640636, 489.5691384127891, 506.62411210851883, 531.1906954554254, 556.9097876279076, 530.6488859895906, 484.3705327988569, 457.3394739442057, 479.3707879663867, 488.68755119323487, 513.6499151884348, 530.5748666883358, 566.9638180067476, 517.5313899885341, 501.7028377264229, 455.753228802843, 465.7479893435037, 497.1071814731098, 548.2284008422266, 555.6063345106335, 526.928180086309, 506.4894541195935, 523.1560660729132, 503.94898714801434, 475.00734258046026, 503.9428635136066, 549.9213189964555, 582.2635219655775, 474.3202288325359, 577.4080265554546, 595.5412601391682, 608.3127242918488, 632.0495888456394, 651.3938919265279, 614.0514386825193, 602.4768162988236, 564.1908500037051, 523.8038253445413, 557.3809715610556, 552.7079206858525, 580.3261293762168, 608.5341141429764, 588.9150179902352, 565.932164198883, 551.877164414291, 527.399206992813, 495.11970221689637, 505.6386257937573, 511.2305049197128, 549.2324427068688, 528.5502984921507, 528.8941032610322, 554.499633418184, 525.302665105528, 499.8086055902553, 495.1021362037912, 501.7341398144905, 499.8768066270951, 521.2477892633998, 515.581979357821, 556.7969609300011, 536.7604028815688, 499.95789650183633, 494.59992118873174, 503.07927979516563, 509.7588812433807, 525.364084615446, 538.0300799497696, 567.473311983927, 537.1057243804296, 484.19854855085515, 470.55739391115753, 487.9975837619086, 507.5524104243031, 524.7511946112602, 545.4455391370179, 568.4533624766334, 520.3183186948964, 514.9653128831019, 470.9526096206569, 480.4162626576387, 511.50852299464873, 561.8315822151832, 563.0902236927486, 530.1283727264181, 515.7857393236293, 525.7414383083121, 507.661876746583, 486.8849085593546, 514.1108423908454, 556.9991549427078, 586.3996016417439, 475.48291156199843, 574.9611473753487, 593.6762444516128, 602.7694529709657, 627.1096364639724, 649.501083731492, 607.8154160239777, 602.3600904902357, 559.3669315048538, 527.326531561947, 549.1635010191162, 554.9843918974443, 579.0960938927936, 606.6518853967978, 590.8252418505117, 565.7411131628731, 551.4673053717934, 525.731261464155, 492.02851847073435, 502.66262968049983, 514.7707320219745, 547.8518428868566, 533.883063498757, 537.9911666536057, 546.8943216214086, 520.6562024107293, 503.37203173546976, 497.10363801891083, 502.9755282950462, 498.9018575391919, 527.9341742295172, 525.8150700139917, 556.853258228704, 531.8481910633619, 503.5744422567269, 496.8110686930743, 502.57478302244414, 502.5007419341469, 528.8337716544842, 546.635477711091, 569.6749271336915, 534.8918248595788, 492.1272132547889, 471.34082863886704, 494.398935034598, 507.243973656023, 533.5282066997811, 549.1711467919214, 567.3443819138944, 522.2442968223613, 513.4835554190843, 478.42771643376597, 487.4726697103815, 518.6996578790994, 565.5392201261449, 565.9139181052064, 523.1028186753196, 511.5160538337613, 529.9123000575324, 518.5660526221947, 498.3256749204917, 519.0311083487888, 559.9304954047765, 584.9649924010974, 480.31409228543896, 576.8466604339936, 592.564389206825, 599.7353739593851, 628.1326824887624, 648.4866784275769, 605.6211752480821, 597.5443317337507, 561.063503125076, 515.5142615826722, 546.2662398865323, 548.677881500754, 578.1235156247079, 606.3562014971507, 584.439962542852, 562.7398773695716, 549.4468373026792, 519.5738949226102, 488.09934305363583, 499.26533855400015, 508.88107188375574, 547.7336117021616, 536.4361838513404, 534.5910936418993, 549.4449659991104, 514.9963391694229, 501.9880021886903, 492.0771152603296, 493.64174080664395, 498.5704456815659, 524.5297220717064, 531.1434278217316, 563.6017835985595, 529.7803729451797, 496.8749906820539, 493.2169591660763, 503.41937167853683, 509.61559541919854, 531.3134826015935, 544.1697867264098, 568.1525007529237, 537.8019279908533, 489.6300087552258, 475.3613438868699, 499.8369948630976, 513.7057803149837, 528.1913031471709, 548.6437353025414, 566.7917952783148, 523.763157357749, 517.5074962626819, 487.0990450617744, 494.0894619677021, 517.5175091049088, 565.8350849494549, 566.7009553612536, 531.9020873215827, 512.4365522706709, 529.5270930471443, 521.0995813991644, 496.29734348737503, 522.7991037504027, 567.2888485186246, 592.267588190426, 489.0275368540101, 580.8797007967802, 594.7972252799159, 601.6359231957915, 636.4387225936163, 653.2520927022264, 603.6428018790497, 594.2327429354007, 559.6208348163851, 513.7458714945352, 541.4931470471773, 550.7646081413799, 571.7290084196964, 605.8697679769537, 577.7789209690205, 555.3586455001406, 549.0743555937299, 512.9502487286289, 480.0322115874782, 491.93439390140526, 502.0059278310238, 543.8366369307238, 526.9418014673947, 530.2109064492575, 550.2917536812989, 513.5824690204454, 494.4495846940744, 487.84909673629437, 489.5953395290861, 491.96468957176245, 517.4853536865321, 521.0748521815452, 565.7321775640877, 528.6334968626429, 494.0318297346588, 478.56259739507357, 495.8789336785388, 495.2544147599049, 517.0852203500373, 537.8919222259149, 564.5156831497873, 534.1741608731529, 488.76407977242224, 463.971508584339, 481.34292365172126, 500.3584707683901, 523.6123289930547, 546.9962337321173, 567.3118445383278, 519.6292178302157, 508.22191161808996, 467.8805978304004, 485.26427623463235, 512.8011415877495, 562.4067179327259, 564.2850117519483, 533.0009173108986, 505.9731236383659, 525.1863022399301, 515.4714344319765, 500.0606070255451, 521.7366136009205, 556.8220016408129, 587.4863492298416, 489.2491258839982, 579.5781981197996, 597.5230262544967, 610.5357117784279, 642.3352153836177, 662.8302691620784, 610.6642157291299, 596.5834554600845, 564.0724162768915, 508.88329315143443, 528.0595911628876, 543.8145798626397, 566.4422387677747, 601.091030466613, 571.606843992468, 545.8358837443193, 538.3711970194504, 502.4040618776892, 466.99770318715593, 472.49791534754974, 489.64907773699986, 529.6317706030699, 519.5086736566785, 519.701624617374, 546.5185124209013, 512.0380238574462, 478.4706083564838, 472.06898133625987, 474.2425093724357, 479.4067424378606, 514.4880386581546, 515.9253003069693, 563.1834848979572, 525.5501163893263, 486.4823905828813, 461.4084937265135, 479.84608720315504, 479.93911220633476, 508.98738911014385, 534.4766377100456, 568.8067159206909, 531.5136779280256, 480.46645218073655, 451.47366205049644, 468.74703315966804, 483.7320507586777, 516.7665777625872, 541.3254248079598, 573.3738600319843, 519.407651983578, 497.25719212127746, 459.69406018927145, 481.42811080159834, 504.1196934462943, 560.7764686765812, 559.9373095260111, 530.9237295320326, 507.0894795942571, 521.3006265367796, 506.0614873462108, 491.58406342254284, 515.8657702156339, 563.3076170573231, 590.2486405723266, 490.3317827086238, 582.5492455836177, 601.3762228435903, 616.2193034839147, 648.6118435787297, 666.712943934393, 613.034649480652, 597.9017135874816, 560.711958861389, 495.97654592114935, 518.7255665941678, 530.9132569608873, 561.976496555652, 594.3644201329153, 562.0610058786814, 531.1011981439648, 531.6473313801806, 490.4905890981639, 443.17366150030716, 452.08591224654435, 466.69468726375334, 513.834164467923, 497.65635177933507, 504.0206979653526, 547.9713532578872, 506.58422992478245, 451.9067757193682, 435.100355688001, 453.01824289108464, 457.5412630499186, 493.41563716159357, 496.36232431107555, 562.3412524555158, 506.2946942506353, 455.5408980502098, 433.15277837889977, 456.68609629243264, 465.80395476692553, 487.616352354114, 518.1582843467289, 570.4124753138367, 528.5392485909878, 455.31684778299814, 429.8845269290407, 443.2245578206762, 465.23491631331353, 502.14529498062535, 533.6751359141922, 568.161298146898, 509.52551715284994, 489.33946475949915, 444.0606321437323, 459.43993454662046, 488.3736552850643, 555.6204492029308, 556.3838380633855, 531.7193047151545, 497.0581988976852, 512.7446270203887, 501.8636523646675, 486.3789069179191, 511.51959865812086, 554.6641124570032, 584.8581087389001, 479.36228103635824, 576.4446364563655, 606.6786107193773, 618.1640523477636, 655.7983082831767, 678.391102903879, 612.1967994777426, 606.4190960936302, 552.1492171970016, 492.421915260235, 502.6602609281489, 510.3284750058101, 546.8113553812894, 597.1073097839246, 553.0853887209194, 522.4475133078589, 534.3947633224481, 476.312255189195, 422.54515001619046, 423.1231358053555, 440.08816420831374, 495.66456515086463, 471.96493463416215, 484.5187771245795, 533.4443478023343, 490.6679301706194, 436.09889696233864, 413.51656024937574, 428.73328313515606, 427.45998151647507, 473.9165768097553, 476.22031183374867, 552.6959486978013, 496.9409161824423, 434.36341857844957, 392.4621270567906, 428.6779166218655, 434.5408722258098, 461.40040889081746, 507.10652262485985, 558.2643856885201, 521.5489164754196, 430.8171729662807, 394.18025312300284, 418.4101536024201, 432.8786984136078, 478.80616759150286, 517.1744720519484, 561.9328698313133, 498.7231910563186, 477.65408979229915, 421.2499644963649, 439.55342389451584, 471.1004711411008, 540.9815889411204, 545.5557650805665, 523.8864899236387, 483.3651871794029, 500.8908730324584, 486.0543800799305, 470.5824489360024, 494.16561178494476, 546.8412805918498, 581.7930200351784, 477.1988255772213, 573.56212275481, 608.4593852890566, 616.9768369346594, 659.4672240786751, 685.8243559380057, 616.5658985179518, 610.3879340430937, 562.8245847443955, 481.85531574287893, 490.05264634438413, 493.86629918061965, 523.5478537763728, 580.4551133342533, 531.3094508542548, 509.20876776133304, 522.5510035519065, 470.3282194129543, 381.8040625036259, 382.8589494962953, 393.3063828396779, 471.9895198842351, 449.7238470581281, 466.24673465066536, 516.8951005672087, 473.97558028534604, 405.25501748096093, 374.48155031274905, 391.3045482647339, 394.494687493795, 438.97140764010186, 450.8482460604274, 541.2484834948576, 488.402744243165, 405.24899805096265, 360.46604517651156, 391.78158413671997, 404.969989132567, 444.11501235341916, 486.2411484518981, 550.6518346208704, 509.8753269919765, 398.7074296299176, 357.41332741863715, 379.059681594053, 397.79599924682367, 454.17663272286916, 491.9436630931946, 555.9916040432023, 490.2380336980103, 458.806401502196, 388.03737278386114, 412.82791715067066, 443.6396286513992, 527.5363559594463, 531.5531734257684, 520.2513675960239, 476.31631419859906, 482.6920061333565, 466.94597515477693, 439.8010815699498, 474.5188880376064, 538.5093687573383, 569.6193845560293, 475.4610720887351, 577.0274666986084, 604.7784208784823, 617.8928165274267, 659.5635897039795, 687.1893635870438, 612.8568088319709, 613.3512603189245, 556.854647387945, 468.3957917298691, 481.21267879273853, 480.0050286762615, 505.9782258631648, 557.5555395530507, 515.6199914511018, 495.124513929702, 507.46486792316426, 449.5223001788329, 350.28068636665756, 355.9372418910397, 364.3446739297843, 442.0029307117423, 421.217210728024, 431.22419659572455, 501.4596352001714, 454.3029900503529, 366.7598501364122, 326.2934363604502, 355.7892295702846, 362.90028189660734, 407.94674476228727, 423.6758887575423, 524.8422913706588, 464.75031049741233, 376.4580639473432, 313.0885897448282, 351.86642921846226, 373.48831137850374, 396.9182319901516, 453.1330195625659, 540.3656780743219, 499.75859793972216, 369.68559505635693, 326.5814156758922, 338.0433727500353, 361.33848817772474, 422.0689615246162, 467.02947931596213, 547.8197293523183, 467.88619620595694, 437.67591607699376, 352.6263861662456, 368.0422556547238, 411.26101251427036, 505.18856505621784, 526.2420483588331, 512.9275754917338, 470.8586776678117, 463.6377820920346, 442.7931186295332, 408.99843187118404, 443.6206029455355, 515.7396895826263, 562.0870068796701, 462.91155115083245, 572.7468207347498, 606.372038033684, 616.8449368025359, 664.2991001581049, 686.4789917549358, 615.671860562454, 606.7400954019918, 551.9059584671376, 474.536016212731, 481.55956402367934, 459.2905222087156, 503.6642634270566, 552.7572067288932, 491.1002217170999, 487.48638690694906, 498.29955743152266, 444.16794562443397, 323.13912842125444, 336.13680125285435, 326.57950709389695, 418.01587985223074, 387.8131714884726, 399.8698014901153, 491.0388069919816, 452.00435549674756, 343.5948734416547, 305.5916072127131, 312.27768028626, 317.5129699607171, 377.7095556845174, 388.2525254792967, 509.8152264167778, 461.58094608233415, 355.74359060546186, 292.16763215688906, 315.71107920177076, 318.0289432024912, 355.3965576966777, 419.77196419913446, 514.8874559962621, 487.44688818124666, 345.3136213421832, 296.5746281451821, 303.5924196154858, 333.1367323193271, 396.83303797575365, 443.95659742241196, 534.0395358413683, 467.8939158203889, 422.0728151728878, 321.52897019713845, 346.64815659818987, 394.65449456120774, 488.406563806193, 509.91907093290115, 503.6797674053817, 455.9474084490924, 449.3374064937855, 412.77320392781036, 380.9404548535223, 419.42200218039073, 494.81109773333685, 547.9627599565797, 455.8743878687598, 573.3311290190838, 603.4405314445585, 617.5817896648327, 660.6331466309897, 688.774122127933, 621.6174723367963, 610.3712947085387, 545.8073405918934, 465.2309371387916, 470.9254283590716, 452.76415805061754, 491.9494063031607, 541.5376912689179, 484.3906637832488, 475.0481171211961, 488.5323950156502, 447.842673319818, 314.49318133905916, 323.6741868971272, 326.172691781504, 402.56154195129625, 366.932613301551, 382.07917297287435, 465.5932799101909, 444.0315616249128, 337.0589333210076, 303.0366793303061, 307.9298728199623, 302.0536944350597, 358.5004464806608, 366.5464896792317, 490.1371436307462, 446.58942182629556, 357.8421119057744, 284.69995546468505, 299.5534472454605, 314.3191597829065, 351.8018768005616, 408.4306391099779, 506.58765936915887, 482.6273897394021, 345.4836487673425, 298.4933450772173, 299.3655101372532, 315.2173720124633, 381.22648918591193, 428.0739138398105, 534.9880470239021, 461.0333254870748, 415.0308648177139, 316.6387827420485, 333.88671471201474, 376.7376808076655, 472.57205395210315, 503.28819441625603, 495.48696162483066, 444.1785577304661, 440.86620317461234, 404.67333462061595, 355.5542421150929, 405.3389724781237, 479.8399014474767, 537.9762513799107, 440.15376453027835, 573.1651951426539, 602.4389480195703, 614.1831847794898, 660.4230328311236, 682.2021936911553, 622.0255057369353, 608.1511168518902, 549.0234479522741, 464.8225826373579, 471.7088635525338, 447.7647792681227, 494.49901818514155, 550.4607723869592, 472.6939668478834, 469.39350764049425, 470.2496620211696, 453.06777542440847, 313.53631568997037, 328.26196886148585, 326.8184199262019, 400.32654383171547, 359.1603535450142, 357.87348273748665, 452.099793373306, 438.86592310876875, 343.8550322014224, 308.3379163101082, 311.015177930433, 315.329990782683, 358.2583506316792, 376.3948731365509, 470.5979114398537, 450.7539520573096, 360.8045078133629, 290.26172540491393, 310.54716651684447, 322.47207474451557, 354.3622411562937, 402.0960874217916, 490.84105304805144, 472.20902999937175, 347.80664906539613, 294.50785819304616, 304.35321060446137, 322.92983228886, 383.6009897064122, 420.9296316960477, 516.1601257749631, 461.6837541328153, 409.0082656213374, 316.45389063433663, 316.44396296103486, 378.57047323280653, 469.6579220541089, 501.64926728460875, 491.17947334079554, 439.57890562902634, 444.522003506315, 397.61169521870096, 348.0913898225432, 397.5373423745607, 472.2932521245751, 529.430782282191, 413.2228435822307};

bool SetupVL53L8CX() {
  // Enable PWREN pin if present
  if (PWREN_PIN >= 0) {
    pinMode(PWREN_PIN, OUTPUT);
    digitalWrite(PWREN_PIN, HIGH);
    delay(10);
  }

  // Initialize I2C bus.
  DEV_I2C.begin(39,40);
  DEV_I2C.setClock(1000000); //Sensor has max I2C freq of 1MHz

  
  // Configure VL53L8CX component.
  sensor_VL53L8CX_top.begin();
  sensor_VL53L8CX_top.init_sensor();
  sensor_VL53L8CX_top.vl53l8cx_set_ranging_frequency_hz(30);
  sensor_VL53L8CX_top.vl53l8cx_set_resolution(res);

  Serial.println("starting to measure");
  // Start Measurements.
  sensor_VL53L8CX_top.vl53l8cx_start_ranging(); 

  return true;
}

VL53L8CX_ResultsData Results;
uint8_t NewDataReady = 0;
uint8_t status;
int lastReading = 0;
bool ReadVL53L8CX(float* input,
                       int length, bool reset_buffer) {
                        // Clear the buffer if required, e.g. after a successful prediction

  int8_t i, j, k, l;
  uint8_t zones_per_line;
  uint8_t number_of_zones = res;

  zones_per_line = (number_of_zones == 16) ? 4 : 8;
  if (reset_buffer) {
    memset(save_data, 0, RING_BUFFER_SIZE * sizeof(float)*64);
    begin_index = 0;
    pending_initial_data = true;
  }
  status = sensor_VL53L8CX_top.vl53l8cx_check_data_ready(&NewDataReady);
  if ((!status) && (NewDataReady != 0)) {

    status = sensor_VL53L8CX_top.vl53l8cx_get_ranging_data(&Results);
    for (j = 0; j < number_of_zones; j += zones_per_line)
    {
      for (l = 0; l < VL53L8CX_NB_TARGET_PER_ZONE; l++)
      {
        for (k = (zones_per_line - 1); k >= 0; k--)
        {
          if((float)(&Results)->target_status[(VL53L8CX_NB_TARGET_PER_ZONE * (j+k)) + l] == 255.0 || (float)(&Results)->distance_mm[(VL53L8CX_NB_TARGET_PER_ZONE * (j+k)) + l] > 2000.0){
            save_data[begin_index++] = 0.0;
          } else {
            save_data[begin_index++] = (float)(&Results)->distance_mm[(VL53L8CX_NB_TARGET_PER_ZONE * (j+k)) + l];
          }
        }
      }
    }

    NewDataReady = 0;
    // If we reached the end of the circle buffer, reset
    if (begin_index >= (RING_BUFFER_SIZE)) {
      begin_index = 0;
      // Check if we are ready for prediction or still pending more initial data
      if (pending_initial_data) {
        pending_initial_data = false;
      }
    }

    // Return if we don't have enough data
    if (pending_initial_data) {
      return false;
    }

    // Copy the requested number of bytes to the provided input tensor

    for (int i = 0; i < length; ++i) {
      int ring_array_index = begin_index + i - length;
      if (ring_array_index < 0) {
        ring_array_index += (RING_BUFFER_SIZE);
      }
      input[i] = (save_data[ring_array_index]-means[i])/std_deviations[i];
      // Serial.print(input[i]);
      // Serial.print(",");
    }
    // Serial.print("\n");
    return true;
  }
  
  return false;
}
